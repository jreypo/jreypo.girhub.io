<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>HP Virtual Connect Domain Setup - Part 3: Storage setup &#8211; Juanma's Blog</title>
<meta name="description" content="Welcome to the third post of the Virtual Connect series!

">
<meta name="keywords" content="Fibre Channel, HP, HP BladeSystem, Storage, VCEM, VCM, Virtual Connect, Virtual Connect Manager">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="HP Virtual Connect Domain Setup - Part 3: Storage setup">
<meta name="twitter:description" content="Welcome to the third post of the Virtual Connect series!

">
<meta name="twitter:site" content="@jreypo">
<meta name="twitter:creator" content="@jreypo">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/banner-blades.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="HP Virtual Connect Domain Setup - Part 3: Storage setup">
<meta property="og:description" content="Welcome to the third post of the Virtual Connect series!

">
<meta property="og:url" content="/hp/networking/storage/virtualization/hp-virtual-connect-domain-setup-part-3-storage-setup/">
<meta property="og:site_name" content="Juanma's Blog">

<meta property="og:image" content="/images/banner-blades.png">






<link rel="canonical" href="/hp/networking/storage/virtualization/hp-virtual-connect-domain-setup-part-3-storage-setup/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Juanma's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Juanma's Blog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				        
				    
				    <li><a href="/vmware-hp-links/" >HP Resources for VMware</a></li>
				
				    
				        
				    
				    <li><a href="/tags/" >Tags</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img src=
    
      "/images/banner-blades.png"
    
  alt="HP Virtual Connect Domain Setup - Part 3: Storage setup feature image">
  
  </div><!-- /.image-wrap -->


<div id="main" role="main">
  <div class="article-author-side">
    
  

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/bio-photo-2.jpg" class="bio-photo" alt="Juan Manuel Rey bio photo">


  <h3 itemprop="name">Juan Manuel Rey</h3>
  <p>Unix Geek. Sysadmin by heart turned cloud architect for VMware.</p>
  <a href="mailto:Juan Manuel Rey" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  <a href="http://plus.google.com/+JuanManuelReyPortal" class="author-social" target="_blank"><i class="fa fa-fw fa-google-plus-square"></i> Google+</a>
  <a href="http://linkedin.com/in/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  <a href="http://stackoverflow.com/users/2454288/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i> Stackoverflow</a>
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/hp/networking/storage/virtualization/hp-virtual-connect-domain-setup-part-3-storage-setup/" rel="bookmark" title="HP Virtual Connect Domain Setup - Part 3: Storage setup">HP Virtual Connect Domain Setup - Part 3: Storage setup</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>Welcome to the third post of the <a href="http://www.hp.com/go/VirtualConnect">Virtual Connect</a> series!</p>

<p>The first two posts were about <a href="/hp/networking/virtualization/hp-virtual-connect-domain-setup-part-1-domain-setup-wizard/" title="HP Virtual Connect Domain Setup – Part 1: Domain Setup Wizard">initial VC Domain creation</a> and the <a href="/hp/networking/virtualization/hp-virtual-connect-domain-setup-part-2-network-setup/" title="HP Virtual Connect Domain Setup – Part 2: Network Setup">Network setup</a>. In this one I’ll explain the storage configuration of the Domain using the <strong>Fibre Channel Setup Wizard</strong>.</p>

<p>Please take into account that <strong>iSCSI</strong> is supported with Virtual Connect since the version 3.10 of Virtual Connect Manager and only with the Flex-10 and FlexFabric modules. However I’m going to leave iSCSI configuration for a future post, since I didn’t have many opportunities to try it with VC, and write only about Fibre Channel.</p>

<p>Before we start with the wizard and all the setup task is important to explain the Virtual Connect storage fundamentals.</p>

<p>The first concept to understand are the several key Fibre Channel port types. There a three basic FC ports:</p>

<ul>
  <li><strong>N_Port (Node Port)</strong> - An N_Port is a port within a node that provides Fibre Channel attachment like an HBA port. VC-FC module uplink ports are N_ports.</li>
  <li><strong>F_Port (Fabric Port)</strong> - This a port on a FC switch connected to an N_port and addressable by it. These are commonly used in Edge or Core switches. The VC-FC module’s downlink ports are F_ports in order to allow the HBAs to login into them.</li>
  <li><strong>E_Port (Expansion Port)</strong> - These are switch ports used for switch-to-switch connections known as Inter Switch Link or ISL.</li>
</ul>

<p>Additionally there are two other ports, however these ports are not typically seen in Virtual Connect environments.</p>

<ul>
  <li><strong>NL_Port (Node Loop Port)</strong> - An N_port capable of Arbitrated Loop function.</li>
  <li><strong>FL_Port (Fabric Loop Port)</strong> - An F_port capable of Arbitrated Loop function.</li>
</ul>

<p>The next key concept to understand in <strong>N_Port ID Virtualization</strong> or <strong>NPIV</strong>. It’s a T11 FC standard than can be defined as a Fibre Channel facility that allows to assign multiple N_Port_IDs to a single N_Port, this is a physical N_port having multiple port WWNs. Of course the VC-FC module must be connected to a Fibre Channel switch that supports NPIV.</p>

<p>And how manages Virtual Connect all this port stuff? I believe that an image is worth a thousand words, so first I will show with the below diagrams illustrate how FC ports and SAN are managed with and without Virtual Connect.</p>

<p><a href="/images/blade-san-novc.png"><img src="/images/blade-san-novc.png" alt="" title="SAN config without VC" /></a></p>

<p>As it can be seen the SAN switches, like the <a href="http://h18000.www1.hp.com/storage/saninfrastructure/switches/mds9124e/index.html">Cisco MDS 9124e</a>, that can be used in any blade enclosure including the HP ones are part of the SAN Fabric, that means the enclosure itself is part of the Fabric. These switches are connected to the SAN Core via E_ports or ISL.</p>

<p><a href="{site.url}/images/hp-vc-fc.png"><img src="/images/hp-vc-fc.png" alt="" title="SAN config with VC" /></a></p>

<p>In this configuration the SAN boundary has been moved out of the enclosure. The VC-FC module includes an HBA Aggregator which is an NPIV device. It passes, transparently, the signals from multiple HBAs to a single switch port.</p>

<p>Here it is how the whole process would go:</p>

<ol>
  <li>VC-FC module uplink port issue a Login Request, a <em>FLOGI</em> to the SAN and advertise itself as NPIV capable port.</li>
  <li>Upon receiving an <em>Accept</em> from the Fabric it would begin to process server requests.</li>
  <li>Server HBAs would begin normal Fabric login process with the WWNs.</li>
  <li>VC-FC module would translate <em>FLOGI</em> requests into an <em>FDISC</em> requests since a single N_Port can only receive one <em>FLOGI</em> request.</li>
  <li>SAN switch would reply with an <em>Accept</em> and provide HBAs with Fabric addresses.</li>
  <li>The <em>Accept</em> frames would reach uninterrupted the HBAs.</li>
  <li>From then on all the traffic will be carried over the sane link for all HBA connections.</li>
</ol>

<p>Now the the basic concepts are explained and, hopefully clear, it’s tim to configure the storage.</p>

<p>We are going to use the <strong>Fibre Channel Setup Wizard</strong> to:</p>

<ul>
  <li>Identify the World Wide Names (WWNs) to be used by the servers.</li>
  <li>Define the available SAN fabrics.</li>
</ul>

<p>You can launch the wizard either from the Tools menu in the Virtua Connect page or right after finishing the <strong>Network Setup Wizard</strong>. From the welcome screen click Next and move into the <strong>World Wide Name (WWN) Settings</strong> page.</p>

<p>In this first page you can specify if you want to use the WWN settings that comes with the Fiber Channel HBA card or if the HP Virtual Connect supplied WWN settings.</p>

<p><a href="/images/fc_wizard_1.png"><img src="/images/fc_wizard_1.png" alt="" /></a></p>

<p>Virtual Connect will assign both a port WWN and a node WWN to a Fibre Channel port, the node WWN will always be the same as the port WWN incremented by one.</p>

<p>There is key advantage when configuring Virtual Connect to assign the WWNs and is that, since it maintains a consistent storage identity, it allows blades to be replaced in case of failure without affecting the external SAN.</p>

<p>In the wizard select <strong>Virtual Connect assigned WWNs</strong> and click <strong>Next</strong> to move into the <strong>Assigned WWNs</strong> screen.</p>

<p><a href="/images/fc_wizard_2.png"><img src="/images/fc_wizard_2.png" alt="" /></a></p>

<p>This screen is very similar to the MAC address range selection screen we saw in the previous post. Here you have to choose between an user defined WWNs range and an HP defined one. You must ensure that the selected range is unique within the environment.</p>

<p>Next we are going to define the Fabric, first you’ll be presented with a screen asking if you want to define the fabric.</p>

<p><a href="/images/fc_wizard_3.png"><img src="/images/fc_wizard_3.png" alt="" /></a></p>

<p>After that we have to enter the Fabric name, assign the uplink ports and configure the speed.</p>

<p><a href="/images/fc_wizard_4.png"><img src="/images/fc_wizard_4.png" alt="" title="fc_" /></a></p>

<p>After applying the configuration the wizard will move to the next screen where it will ask if you want to create more Fabric, for the example purposes I decided to create a another one named <em>fabric_prod2</em>.</p>

<p><a href="/images/fc_wizard_6.png"><img src="/images/fc_wizard_6.png" alt="" /></a></p>

<p>When you are done with the second fabric finish the wizard and the storage setup will be done. You can review and modify the configuration from the Virtual Connect main interface.</p>

<p><a href="/images/vc-config.png"><img src="/images/vc-config.png" alt="" title="Virtual Connect main page" /></a></p>

<p>The next post will be the last of the series and I will discuss about <strong>Virtual Connect Server Profiles</strong>. As always any feedback would be welcome.</p>

<p>Juanma.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/hp/networking/storage/virtualization/hp-virtual-connect-domain-setup-part-3-storage-setup/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/hp/networking/storage/virtualization/hp-virtual-connect-domain-setup-part-3-storage-setup/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/hp/networking/storage/virtualization/hp-virtual-connect-domain-setup-part-3-storage-setup/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>HP Virtual Connect Domain Setup - Part 3: Storage setup</strong> was published on <time datetime="2011-01-05T13:46:09+01:00">January 05, 2011</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/openstack/vmware/upgrading-vmware-integrated-openstack/" title="Upgrading VMware Integrated OpenStack">Upgrading VMware Integrated OpenStack</a></li>
    
      <li><a href="/cloud/openstack/give-me-openstack-and-give-me-liberty/" title="Give me OpenStack and give me Liberty!">Give me OpenStack and give me Liberty!</a></li>
    
      <li><a href="/linux/red%20hat/sysadmin/dnf-the-new-fedora-package-manager/" title="DNF, the new Fedora package manager">DNF, the new Fedora package manager</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Juan Manuel Rey. <br> Hosted on <a href="https://pages.github.com" rel="nofollow" target="_blank">GitHub Pages</a> and powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
