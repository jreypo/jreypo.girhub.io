<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Upgrading VMware Integrated OpenStack &#8211; Juanma's Blog</title>
<meta name="description" content="In
a previous article I showed the process to patch an existing VIO 1.0
installation, which
as you were able to see it is a clean and easy process. VMware announced
VMware Integrated OpenStack 2.0 during VMware US and it finally
became GA a few weeks ago.

">
<meta name="keywords" content="Cloud, devops, OpenStack, OpenStack Kilo, sysadmin, VIO, VIO 2.0, VIO upgrade, VMware, VMware Integrated OpenStack">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="Upgrading VMware Integrated OpenStack">
<meta name="twitter:description" content="In
a previous article I showed the process to patch an existing VIO 1.0
installation, which
as you were able to see it is a clean and easy process. VMware announced
VMware Integrated OpenStack 2.0 during VMware US and it finally
became GA a few weeks ago.

">
<meta name="twitter:site" content="@jreypo">


<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Upgrading VMware Integrated OpenStack">
<meta property="og:description" content="In
a previous article I showed the process to patch an existing VIO 1.0
installation, which
as you were able to see it is a clean and easy process. VMware announced
VMware Integrated OpenStack 2.0 during VMware US and it finally
became GA a few weeks ago.

">
<meta property="og:url" content="/openstack/vmware/upgrading-vmware-integrated-openstack/">
<meta property="og:site_name" content="Juanma's Blog">

<meta property="og:image" content="/images/default-thumb.png">






<link rel="canonical" href="/openstack/vmware/upgrading-vmware-integrated-openstack/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Juanma's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Juanma's Blog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				        
				    
				    <li><a href="/vmware-hp-links/" >HP Resources for VMware</a></li>
				
				    
				        
				    
				    <li><a href="/tags/" >Tags</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    
  

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/" class="bio-photo" alt=" bio photo">


  <h3 itemprop="name"></h3>
  <p></p>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/openstack/vmware/upgrading-vmware-integrated-openstack/" rel="bookmark" title="Upgrading VMware Integrated OpenStack">Upgrading VMware Integrated OpenStack</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p><a href="https://jreypo.files.wordpress.com/2015/03/teamopenstackvmware.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/teamopenstackvmware.png?w=300" alt="Team+OpenStack+@+VMware" /></a>In
a previous article I showed the process to <a href="https://jreypo.wordpress.com/2015/04/29/how-to-patch-your-vio-environment/">patch an existing VIO 1.0
installation</a>, which
as you were able to see it is a clean and easy process. VMware announced
<strong>VMware Integrated OpenStack 2.0</strong> during VMware US and it finally
became GA a few weeks ago.</p>

<p>This new version of VIO has all OpenStack code updated up to the latest
Kilo release and comes packaged with many interesting features like
Load-Balancing-as-a-Service (LBaaS) or auto-scaling capabilities based
on Heat and Ceilometer.</p>

<p>With a new VIO version hot of the press it is time now to upgrade your
VIO 1.0.x environment to 2.0 and take advantage of all those new great
goodies. The upgrade process is pretty straightforward and consist of
three main stages.</p>

<ul>
  <li>Upgrade VIO Management Server</li>
  <li>Deploy a new VIO 2.0 environment</li>
  <li>Perform the data migration</li>
</ul>

<p>Keep in mind that you will need to have enough hardware resources in
your management cluster to be able to host two full fledged VIO
installations at the same time during the migration process. Just for
the sake of transparency, the lab environment where I test the upgrade
is based on vSphere 5.5 Update 2, NSX for vSphere 6.1.4 and VIO 1.0.2.</p>

<h3 id="step-1---upgrade-vio-management-server">Step 1 - Upgrade VIO Management Server</h3>

<p>From VMware website download the <code>.deb</code> upgrade package and upload it to
VIO Management Server.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/screen-shot-2015-10-20-at-12-59-50.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/screen-shot-2015-10-20-at-12-59-50.png?w=580" alt="Download VIO upgrade
package" /></a></p>

<p>Stage the upgrade package.</p>

<pre><code>viouser@vio-oms:~$ sudo viopatch add -l vio-1.0-upgrade_2.0.0.3037964_all.deb
[sudo] password for viouser:
vio-1.0-upgrade_2.0.0.3037964_all.deb patch has been added.
viouser@vio-oms:~$ viopatch list
Name            Version       Type   Installed
--------------- ------------- ------ -----------
vio-1.0-upgrade 2.0.0.3037964 infra  No
vio-patch-2     1.0.2.2813500 infra  Yes

viouser@vio-oms:~$
</code></pre>

<p>Upgrade the management server with <code>viopatch</code> command.</p>

<pre><code>viouser@vio-oms:~$ sudo viopatch install -p vio-1.0-upgrade -v 2.0.0.3037964
Installing patch vio-1.0-upgrade version 2.0.0.3037964
done
Installation complete for patch vio-1.0-upgrade version 2.0.0.3037964
viouser@vio-oms:~$
</code></pre>

<p>Go to the vSphere Web Client, logout and log back in to verify that the
new version is correct.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/vio-oms-upgraded.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/vio-oms-upgraded.png?w=580" alt="vio-oms-upgraded" /></a></p>

<h3 id="step-2---deploy-a-new-vio-20-environment">Step 2 - Deploy a new VIO 2.0 environment</h3>

<p>With VIO Management Server upgraded is now time to deploy a fresh 2.0
environment. In the VIO plugin go to <strong>Manage</strong> section and a new
<strong>Upgrades</strong> tab will be there. Before</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/vio-upgrades-tab.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/vio-upgrades-tab.png?w=580" alt="vio-upgrades-tab" /></a></p>

<p>Before starting with the deployment check in the <strong>Networks</strong> tab that
there are enough free IP address for the new deployment, if there aren’t
then add a new IP range.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/new_ip_range.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/new_ip_range.png?w=580" alt="new_ip_range" /></a></p>

<p>Click on the <strong>Upgrad</strong>e <img src="%7B%7B%20site.baseurl%20%7D%7D/assets/screen-shot-2015-10-20-at-13-49-34.png" alt="Screen Shot 2015-10-20 at
13.49.34" />
icon. Select if you want to participate in the Customer experience
improvement program, my recommendation here is to say yes to help our
engineering team to improve VIO upgrade experience even more ;-), and
enter the name for the new deployment.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/deployment_name.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/deployment_name.png?w=580" alt="deployment_name" /></a></p>

<p>Enter the IP addresses for the public and private load balanced IP
addresses, keep in mind that these IP addresses must belong to the API
subnet of the existing VIO 1.0 environment in case of the public and to
the management network segment in the case of the private one.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/lb_vio2_ips.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/lb_vio2_ips.png?w=580" alt="lb_vio2_ips" /></a></p>

<p>In the last screen review the configured values and click <strong>Finish</strong>.
The new environment will be deployed and you will be able to monitor it
from the <strong>Upgrades</strong> tab.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/vio2_new_deployment.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/vio2_new_deployment.png?w=580" alt="vio2_new_deployment" /></a></p>

<h3 id="step-3---migrate-the-data">Step 3 - Migrate the data</h3>

<p>With the new environment up and ready we can start the data migration.
From the <strong>Upgrades</strong> tab right-click in the your existing VIO 1.0
installation and select <strong>Migrate Data</strong>.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/migrate_vio_data.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/migrate_vio_data.png?w=580" alt="migrate_vio_data" /></a></p>

<p>The migration wizard will ask for confirmation, click <strong>OK</strong>. During the
data migration all OpenStack service will be unavailable.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/data_migration.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/data_migration.png?w=580" alt="data_migration" /></a></p>

<p>When the migration process is finished the status of the new VIO 2.0
environment will appear as <strong>Migrated</strong> and the previous VIO 1.0 will
appear as <strong>Stopped</strong>.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/vio_migrated.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/vio_migrated.png?w=580" alt="vio_migrated" /></a></p>

<p>Open a browser and connect the VIO 2.0 public IP to access OpenStack
Horizon interface, login and verify that all your workloads, networks,
image, etc have been properly migrated. Logout from Horizon and go back
to the Web Client. Now that the data has been migrated we need to
migrate the original Public Virtual IP to the new environment.</p>

<p>Right-click on VIO 1.0 deployment and from the menu select <strong>Switch To
New Deployment</strong>.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/switch_vio_ip.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/switch_vio_ip.png?w=580" alt="switch_vio_ip" /></a></p>

<p>A new pop-up will appear asking for confirmation since again the
OpenStack service will be unavailable during the IP reconfiguration.</p>

<p>After the reconfiguration the new VIO 2.0 deployment will be in
<strong>Running</strong> status and the Public Virtual IP will be the same as the
former 1.0 deployment.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/migration_finished.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/migration_finished.png?w=580" alt="migration_finished" /></a></p>

<p>The upgrading procedure is finished. We can now access now Horizon using
the existing FQDN, verify that everything is still working and enjoy
your new OpenStack Kilo environment.</p>

<p><a href="https://jreypo.files.wordpress.com/2015/10/horizon_kilo.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/horizon_kilo.png?w=580" alt="horizon_kilo" /></a></p>

<p>In the same way as patching, with VIO upgrading your OpenStack cloud
does not have to be a painful experience, VIO provides the best
OpenStack experience in a vSphere environment. Kudos to my colleagues of
the <strong>Team OpenStack @ VMware</strong>.</p>

<p>Happy Stacking!</p>

<p>Juanma.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/openstack/vmware/upgrading-vmware-integrated-openstack/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/openstack/vmware/upgrading-vmware-integrated-openstack/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/openstack/vmware/upgrading-vmware-integrated-openstack/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Upgrading VMware Integrated OpenStack</strong> was published on <time datetime="2015-10-21T00:20:24+02:00">October 21, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/cloud/openstack/give-me-openstack-and-give-me-liberty/" title="Give me OpenStack and give me Liberty!">Give me OpenStack and give me Liberty!</a></li>
    
      <li><a href="/linux/red%20hat/sysadmin/dnf-the-new-fedora-package-manager/" title="DNF, the new Fedora package manager">DNF, the new Fedora package manager</a></li>
    
      <li><a href="/cloud-native/devops/pivotal/first-steps-with-pivotal-lattice/" title="First steps with Pivotal Lattice">First steps with Pivotal Lattice</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Juan Manuel Rey. <br> Hosted on <a href="https://pages.github.com" rel="nofollow" target="_blank">GitHub Pages</a> and powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
