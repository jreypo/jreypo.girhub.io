<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Configure NFS shares in Openfiler for your vSphere homelab &#8211; Juanma's Blog</title>
<meta name="description" content="Even if you have access to the enterprise-class storage appliances, like the
HP P4000 VSA or the EMC Celerra VSA, an Openfiler storage appliance can be a great asset to your homelab. Specially if you, like myself, run an all virtual homelab within VMware Workstation, since Openfiler is by far less resource hunger than its enterprise counterparts.

">
<meta name="keywords" content="ESX, ESX4, ESXi, ESXi4, homelab, NFS, Openfiler, Storage, VMware, vSphere">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="Configure NFS shares in Openfiler for your vSphere homelab">
<meta name="twitter:description" content="Even if you have access to the enterprise-class storage appliances, like the
HP P4000 VSA or the EMC Celerra VSA, an Openfiler storage appliance can be a great asset to your homelab. Specially if you, like myself, run an all virtual homelab within VMware Workstation, since Openfiler is by far less resource hunger than its enterprise counterparts.

">
<meta name="twitter:site" content="@jreypo">
<meta name="twitter:creator" content="@jreypo">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Configure NFS shares in Openfiler for your vSphere homelab">
<meta property="og:description" content="Even if you have access to the enterprise-class storage appliances, like the
HP P4000 VSA or the EMC Celerra VSA, an Openfiler storage appliance can be a great asset to your homelab. Specially if you, like myself, run an all virtual homelab within VMware Workstation, since Openfiler is by far less resource hunger than its enterprise counterparts.

">
<meta property="og:url" content="/storage/virtualization/vmware/configure-nfs-shares-in-openfiler-for-your-vsphere-homelab/">
<meta property="og:site_name" content="Juanma's Blog">

<meta property="og:image" content="/images/default-thumb.png">






<link rel="canonical" href="/storage/virtualization/vmware/configure-nfs-shares-in-openfiler-for-your-vsphere-homelab/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Juanma's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Juanma's Blog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				        
				    
				    <li><a href="/vmware-hp-links/" >HP Resources for VMware</a></li>
				
				    
				        
				    
				    <li><a href="/tags/" >Tags</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    
  

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/bio-photo-2.jpg" class="bio-photo" alt="Juan Manuel Rey bio photo">


  <h3 itemprop="name">Juan Manuel Rey</h3>
  <p>Unix Geek. Sysadmin by heart turned cloud architect for VMware.</p>
  <a href="mailto:Juan Manuel Rey" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  <a href="http://plus.google.com/+JuanManuelReyPortal" class="author-social" target="_blank"><i class="fa fa-fw fa-google-plus-square"></i> Google+</a>
  <a href="http://linkedin.com/in/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  <a href="http://stackoverflow.com/users/2454288/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i> Stackoverflow</a>
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/storage/virtualization/vmware/configure-nfs-shares-in-openfiler-for-your-vsphere-homelab/" rel="bookmark" title="Configure NFS shares in Openfiler for your vSphere homelab">Configure NFS shares in Openfiler for your vSphere homelab</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p><a href="http://jreypo.files.wordpress.com/2010/11/openfiler_logo_71.png"><img src="/images/openfiler_logo_71.png" alt="" title="Openfiler" /></a>Even if you have access to the enterprise-class storage appliances, like the
<a href="http://h18006.www1.hp.com/products/storage/software/vsa/index.html" title="HP P4000 VSA">HP P4000 VSA</a> or the <a href="http://nickapedia.com/2010/10/04/play-it-again-sam-celerra-uber-v3-2/" title="EMC Celerra UBER VSA">EMC Celerra VSA</a>, an <a href="http://www.openfiler.com" title="OpenFiler">Openfiler</a> storage appliance can be a great asset to your homelab. Specially if you, like myself, run an <em>all virtual</em> homelab within VMware Workstation, since Openfiler is by far less resource hunger than its enterprise counterparts.</p>

<p>Simon Seagrave (<a href="http://twitter.com/#!/Kiwi_Si">@Kiwi_Si</a>) from <a href="http://www.techhead.co.uk">TechHead.co.uk</a> wrote an <a href="http://www.techhead.co.uk/how-to-configure-openfiler-v23-iscsi-storage-for-use-with-vmware-esx">excellent article</a> explaining how to add iSCSI LUNs from an Openfiler instance to your ESX/ESXi servers, if iSCSI is your “thing” you should check it.</p>

<p>In this article I’ll explain how-to configure a NFS share in Openfiler and then add it as a datastore to your vSphere servers. I’ll take for granted that you already have an Openfiler server up and running.</p>

<h3 id="step-1---enable-nfs-service">Step 1 - Enable NFS service</h3>

<p>As always point your browser to **https://<openfiler_address>:446**, login and from the main screen go to the **Services** tab and enable the NFSv3 service as shown
below.</openfiler_address></p>

<p><a href="/images/nfs_service.png"><img src="/images/nfs_service.png" alt="" title="NFS service" /></a></p>

<h3 id="step-2---setup-network-access">Step 2 - Setup network access</h3>

<p>From the <strong>System</strong> tab add the network of the ESX servers as authorized. I added the whole network segment but you can also create network access rules per host in order to setup a more secure and granular access policy.</p>

<p><a href="/images/net-access.png"><img src="/images/net-access.png" alt="" title="net-access" /></a></p>

<h3 id="step-3---create-the-volumes">Step 3 - Create the volumes</h3>

<p>The next step is to create the volumes we are going to use as the base for the NFS shares. If like me you’re a Unix/Linux Geek it is for sure that you understand perfectly the PV -&gt; VG -&gt; LV** concepts if not I strongly recommend you to check the TechHead article mentioned above where Simon explained it very well or if you want to go a little deeper with volumes in Unix/Linux my article about <a href="/hp-ux/linux/red%20hat/sysadmin/lvm-and-file-system-basics-in-hp-ux-linux/" title="LVM and file system basics in HP-UX &amp; Linux">volume and filesystem basics in Linux and HP-UX</a>.</p>

<p>First we need to create the physical volumes; go to the <strong>Volumes</strong> tab, enter the Block Devices section and edit the disk to be used for the volumes.</p>

<p><a href="/images/edit-disk.png"><img src="/images/edit-disk.png" alt="" title="Edit disk" /></a></p>

<p>Create a partition and set the type to <strong>Physical Volume</strong>.</p>

<p><a href="/images/create_partition.png"><img src="/images/create_partition.png" alt="" title="create partition" /></a></p>

<p>Once the Physical Volume is created go to the <strong>Volume Groups</strong> section and create a new VG and use for it the new PV.</p>

<p><a href="/images/vg_nfs.png"><img src="/images/vg_nfs.png" alt="" title="vg_nfs" /></a></p>

<p>Finally click on <strong>Add Volume</strong>. In this section you will have to choose the new VG that will contain the new volume, the size, name description and more important the <strong>Filesystem/Volume Type</strong>. There are three type:</p>

<ul>
  <li>iSCSI</li>
  <li>XFS</li>
  <li>Ext3</li>
</ul>

<p>The first is obviously intended for iSCSI volume and the other two for NFS, the criteria to follow here is the scalability since esxt3 supports up to 8TB and XFS up to 10TB.</p>

<p><a href="/11/volume-creation.png"><img src="/images/volume-creation.png" alt="" title="Logical Volume creation" /></a></p>

<p>Click <strong>Create</strong> and the new volume will be created.</p>

<p><a href="/images/new_volume.png"><img src="/images/new_volume.png" alt="" title="New Volume" /></a></p>

<h3 id="step-4---create-the-nfs-share">Step 4 - Create the NFS share</h3>

<p>Go to the <strong>Shares</strong> tab, there you will find the new volume as an available share.</p>

<p><a href="/images/shares.png"><img src="/images/shares.png" alt="" title="shares" /></a></p>

<p>Just to clarify concepts, <strong>this volume IS NOT the real NFS share</strong>. We are going to create a folder into the volume and share that folder through NFS to our ESX/ESXi servers.</p>

<p>Click into the volume name and in the pop-up enter the name of the folder and click <strong>Create folder</strong>.</p>

<p><a href="/images/create_folder.png"><img src="/images/create_folder.png" alt="" title="Create Folder" /></a></p>

<p>Select the folder and in the pop-up click the <strong>Make Share</strong> button.</p>

<p><a href="/images/make_share.png"><img src="/images/make_share.png" alt="" /></a></p>

<p>Finally we are going to configure the newly created share; select the share to enter its configuration area.</p>

<p>Edit the share data to your suit and select the <strong>Access Control Mode</strong>. Two modes are available:</p>

<ul>
  <li>Public guest access - There is no user based authentication.</li>
  <li>Controlled access - The authentication is defined in the Accounts section.</li>
</ul>

<p><a href="/images/edit_share1.png"><img src="/images/edit_share1.png" alt="" title="Edit share" /></a></p>

<p>Since this is only for my homelab I choose Public access.</p>

<p>Next select the share type, for our purposes case I obviously choose NFS and set the permissions as Read-Write.</p>

<p><a href="/images/configure_nfs1.png"><img src="/images/configure_nfs1.png" alt="" title="Configure NFS" /></a></p>

<p>You can also edit the NFS options and configure to suit your personal preferences and/or specifications.</p>

<p><a href="/images/nfs_options.png"><img src="/images/nfs_options.png" alt="" title="NFS options" /></a></p>

<p>Just a final tip for the non-Unix people, if you want to check the NFS share open a SSH session with Openfiler server and as root issue the command <code>showmount -e</code>. The output should look like this.</p>

<p><a href="/images/nfs_check.png"><img src="/images/nfs_check.png" alt="" title="nfs_check" /></a></p>

<p>The Openfiler configuration is done, now we are going to create a new datastore in our ESX servers.</p>

<h3 id="step-5---add-the-datastore-to-the-esx-servers">Step 5 - Add the datastore to the ESX servers</h3>

<p>Now that the share is created and configured it is time to add it to our ESX servers.</p>

<p>As usually from the vSphere Client go to <strong>Configuration -&gt; Storage -&gt; Add storage</strong>.</p>

<p>In the pop-up window choose <strong>Network File System</strong>.</p>

<p><a href="/11/add_nfs_1.png"><img src="/images/add_nfs_1.png" alt="" /></a></p>

<p>Enter in the <strong>Server</strong>, <strong>Folder</strong> and <strong>Datastore Name</strong> label.</p>

<p><a href="/images/add_nfs_2.png"><img src="/images/add_nfs_2.png" alt="" /></a></p>

<p>Finally check the data and click finish. If everything goes well after a few seconds the new datastore should appear.</p>

<p><a href="/images/nfs_datastore1.png"><img src="/images/nfs_datastore1.png" alt="" title="nfs_datastore1" /></a></p>

<p>And with this we are finished. If you see any mistake or have anything to add please comment.</p>

<p>Juanma.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/storage/virtualization/vmware/configure-nfs-shares-in-openfiler-for-your-vsphere-homelab/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/storage/virtualization/vmware/configure-nfs-shares-in-openfiler-for-your-vsphere-homelab/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/storage/virtualization/vmware/configure-nfs-shares-in-openfiler-for-your-vsphere-homelab/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Configure NFS shares in Openfiler for your vSphere homelab</strong> was published on <time datetime="2010-11-30T17:01:42+01:00">November 30, 2010</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/openstack/vmware/upgrading-vmware-integrated-openstack/" title="Upgrading VMware Integrated OpenStack">Upgrading VMware Integrated OpenStack</a></li>
    
      <li><a href="/cloud/openstack/give-me-openstack-and-give-me-liberty/" title="Give me OpenStack and give me Liberty!">Give me OpenStack and give me Liberty!</a></li>
    
      <li><a href="/linux/red%20hat/sysadmin/dnf-the-new-fedora-package-manager/" title="DNF, the new Fedora package manager">DNF, the new Fedora package manager</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Juan Manuel Rey. <br> Hosted on <a href="https://pages.github.com" rel="nofollow" target="_blank">GitHub Pages</a> and powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
