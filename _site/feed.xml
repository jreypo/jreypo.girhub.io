<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
<title type="text">Juanma's Blog</title>
<generator uri="https://github.com/jekyll/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="/feed.xml" />
<link rel="alternate" type="text/html" href="" />
<updated>2015-12-21T23:32:00+01:00</updated>
<id>/</id>
<author>
  <name>Juan Manuel Rey</name>
  <uri>/</uri>
  
</author>


  

<entry>
  <title type="html"><![CDATA[Add iSCSI volumes from HP P4000 VSA to VMware ESXi4]]></title>
  <link rel="alternate" type="text/html" href="/storage/sysadmin/virtualization/vmware/add-iscsi-volumes-from-hp-p4000-vsa-to-vmware-esxi4/" />
  <id>/storage/sysadmin/virtualization/vmware/add-iscsi-volumes-from-hp-p4000-vsa-to-vmware-esxi4</id>
  <published>2010-04-17T00:00:00+02:00</published>
  <updated>2010-04-17T00:00:00+02:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;In today’s post I will try to explain step by step how to add an iSCSI volume from the HP Lefthand P4000 VSA to a VMware ESXi4 server.&lt;/p&gt;

&lt;h3 id=&quot;step-one-create-a-volume&quot;&gt;Step One: Create a volume&lt;/h3&gt;

&lt;p&gt;Lets suppose we already have a configured storage appliance, I showed how to create a cluster in my &lt;a href=&quot;/storage/virtualization/first-hands-on-with-the-hp-lefthand-p4000-vsa/&quot;&gt;previous post&lt;/a&gt; so I will not repeat that part here. Open the Centralized Management Console and go to &lt;strong&gt;Management Group -&amp;gt; Cluster -&amp;gt; Volumes and Snapshots&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/volumes_snapshots.png&quot;&gt;&lt;img src=&quot;/images/volumes_snapshots.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Click on &lt;strong&gt;Tasks&lt;/strong&gt; and choose &lt;strong&gt;New Volume&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/new_volume2.png&quot;&gt;&lt;img src=&quot;/images/new_volume2.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Enter the volume name, a small description and the size. The volume can also be assigned to any server already connected to the cluster, as we don’t have any server assigned this option can be ignored, for now.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/volume_basic.png&quot;&gt;&lt;img src=&quot;/images/volume_basic.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In the &lt;strong&gt;Advanced&lt;/strong&gt; tab the volume can be assigned to an existing cluster and the RAID level, the volume type and the provisioning type can be set.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/volume_advanced.png&quot;&gt;&lt;img src=&quot;/images/volume_advanced.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When everything is configured click OK and the volume will be created. After the creation process, the new volume will be showed up in the CMC.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/new_volume_created.png&quot;&gt;&lt;img src=&quot;/images/new_volume_created.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;At this point we have a new volume with some RAID protection level, none in this particular case since it’s a single node cluster. Next step is to assign the volume to a server.&lt;/p&gt;

&lt;h3 id=&quot;step-two-esxi-iscsi-configuration&quot;&gt;Step Two: ESXi iSCSI configuration&lt;/h3&gt;

&lt;p&gt;Connect to the chosen ESXi4 Server through vSphere Client and from the &lt;strong&gt;Configuration&lt;/strong&gt; tab in the right pane go to the &lt;strong&gt;Networking&lt;/strong&gt; area and click the &lt;em&gt;Add Networking&lt;/em&gt; link&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/esxi_add_networking.png&quot;&gt;&lt;img src=&quot;/images/esxi_add_networking.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In the &lt;strong&gt;Add Networking Wizard* select VMkernel as **Connection Type&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/wizard.png&quot;&gt;&lt;img src=&quot;/images/wizard.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Create a new virtual switch.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/new_vswicth.png&quot;&gt;&lt;img src=&quot;/images/new_vswicth.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Enter the &lt;strong&gt;Port Group Properties&lt;/strong&gt;, in my case the label as no other properties where relevant for me.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/properties.png&quot;&gt;&lt;img src=&quot;/images/properties.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Set the IP settings, go to &lt;strong&gt;Summary&lt;/strong&gt; screen and click &lt;strong&gt;Finish&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/ip.png&quot;&gt;&lt;img src=&quot;/images/ip.png&quot; alt=&quot;IP Settings&quot; title=&quot;IP Settings&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The newly created virtual switch will appear in the &lt;strong&gt;Networking&lt;/strong&gt; area.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vswitch_created.png&quot;&gt;&lt;img src=&quot;/images/vswitch_created.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;With the new virtual switch created go to &lt;strong&gt;Storage Adapters&lt;/strong&gt; there you will see an iSCSI software adapter.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/iscsi_soft_adapter.png&quot;&gt;&lt;img src=&quot;/images/iscsi_soft_adapter.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Click on properties and on the &lt;strong&gt;General&lt;/strong&gt; tab click the &lt;strong&gt;Configure&lt;/strong&gt; button and check the &lt;strong&gt;Enabled&lt;/strong&gt; status box.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/enable_iscsi.png&quot;&gt;&lt;img src=&quot;/images/enable_iscsi.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Once iSCSI is enabled its properties window will be populated.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/iscsi_iqn.png&quot;&gt;&lt;img src=&quot;/images/iscsi_iqn.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Click close, the server will ask for rescan of the adapter but at this point it is not necessary so it can be skipped.&lt;/p&gt;

&lt;h3 id=&quot;step-threeadd-the-volume-to-the-esxi-server&quot;&gt;Step Three: Add the volume to the ESXi server&lt;/h3&gt;

&lt;p&gt;Now, that we have our volume created and the iSCSI adapter of our ESXi server activated, the next step is to add the storage to server.&lt;/p&gt;

&lt;p&gt;On the HP Lefthand CMC go to the servers area add a new server.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/new_server.png&quot;&gt;&lt;img src=&quot;/images/new_server.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Add a name for the server, a small description, check the &lt;strong&gt;Allow access via iSCSI&lt;/strong&gt; box and select the authentication. In the example I choose &lt;strong&gt;CHAP not required&lt;/strong&gt;. With this option you only have to enter the &lt;strong&gt;Initiator Node Name&lt;/strong&gt;, you can grab it from the details of the ESXi iSCSI adapter.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/new_server_2.png&quot;&gt;&lt;img src=&quot;/images/new_server_2.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To finish the process click OK and you will see the newly added server. Go to the &lt;strong&gt;Volume and Snapshots&lt;/strong&gt; tab on the server configuration and from the &lt;strong&gt;Tasks&lt;/strong&gt; menu assign a volume to the server.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/assign_volume.png&quot;&gt;&lt;img src=&quot;/images/assign_volume.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Select the volume created at the beginning,&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/assign_volume_2.png&quot;&gt;&lt;img src=&quot;/images/assign_volume_2.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Now go back to the vSphere client and launch again the properties of the iSCSI adapter. On the &lt;strong&gt;Dynamic Discovery&lt;/strong&gt; tab add the virtual IP address of the VSA cluster.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/dynamic_discovery.png&quot;&gt;&lt;img src=&quot;/images/dynamic_discovery.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Click &lt;strong&gt;Close&lt;/strong&gt; and the server will ask again to rescan the adapter, now say yes and after the rescanning process the iSCSI LUN will show up.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/iscsi_lun.png&quot;&gt;&lt;img src=&quot;/images/iscsi_lun.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Now in the ESXi a new Datastore can be created with the newly configured storage. Of course the same LUN can also be used to provide shared storage for more ESXi servers and used for VMotion, HA or any other interesting VMware vSphere features. May be in another post ;-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/storage/sysadmin/virtualization/vmware/add-iscsi-volumes-from-hp-p4000-vsa-to-vmware-esxi4/&quot;&gt;Add iSCSI volumes from HP P4000 VSA to VMware ESXi4&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on April 17, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[First hands-on with the HP Lefthand P4000 VSA]]></title>
  <link rel="alternate" type="text/html" href="/storage/virtualization/first-hands-on-with-the-hp-lefthand-p4000-vsa/" />
  <id>/storage/virtualization/first-hands-on-with-the-hp-lefthand-p4000-vsa</id>
  <published>2010-04-09T00:00:00+02:00</published>
  <updated>2010-04-09T00:00:00+02:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;The &lt;strong&gt;P400 Virtual Storage Appliance&lt;/strong&gt; is a storage product from HP, its features include:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Synchronous replication to remote sites.&lt;/li&gt;
  &lt;li&gt;Snapshot capability.&lt;/li&gt;
  &lt;li&gt;Thin provisioning.&lt;/li&gt;
  &lt;li&gt;Network RAID.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It can be used to create a virtual iSCSI SAN to provide shared storage for ESX environments.&lt;/p&gt;

&lt;p&gt;A 60-day trial is available &lt;a href=&quot;http://www.hp.com/go/tryvsa&quot;&gt;here&lt;/a&gt;, it requires to log-in with your HP Passport account. As I wanted to test it is what I did, there are two versions available one for ESX and a second one labeled as Laptop Demo which is optimized for VMware Workstation and also comes with the Centralized Management Console software. I choose the last one.&lt;/p&gt;

&lt;p&gt;After the import the appliance into VMware Workstation you will see that it comes configured as &lt;em&gt;Other Linux 2.6x kernel&lt;/em&gt; as guest OS, with 1 vCPU, 384MB of RAM, 2 308MB disks used for the OS of the VSA and a 7.2 GB disk. The three disks are SCSI and are configured as Independent-Persistent.&lt;/p&gt;

&lt;p&gt;At that point I fired up the appliance and started to play with my VSA.&lt;/p&gt;

&lt;h3 id=&quot;first-step---basic-configuration&quot;&gt;First Step - Basic configuration.&lt;/h3&gt;

&lt;p&gt;A couple of minutes after have been started the appliance will show the log-in prompt.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa-2010-04-05-01-26-15.png&quot;&gt;&lt;img src=&quot;/images/vsa-2010-04-05-01-26-15.png&quot; alt=&quot;VSA login prompt&quot; title=&quot;VSA login prompt&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As instructed enter &lt;code&gt;start&lt;/code&gt;. You will be redirected to another log-in screen where you only have to press &lt;em&gt;Enter&lt;/em&gt; and then the configuration screen will appear.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa-2010-04-05-01-26-41.png&quot;&gt;&lt;img src=&quot;/images/vsa-2010-04-05-01-26-41.png&quot; alt=&quot;VSA config screen&quot; title=&quot;VSA config screen&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The first section &lt;code&gt;General Settings&lt;/code&gt; allow you to create an administrator account and to set the password of the default account.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000-2-2010-04-08-23-21-46.png&quot;&gt;&lt;img src=&quot;/images/p4000-2-2010-04-08-23-21-46.png&quot; alt=&quot;VSA Admin creation&quot; title=&quot;VSA Admin creation&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Move to the networking settings. The first screen ask you to choose the network interface, in my case I only had one.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa-2010-04-05-01-29-07.png&quot;&gt;&lt;img src=&quot;/images/vsa-2010-04-05-01-29-07.png&quot; alt=&quot;VSA network interface&quot; title=&quot;VSA network interface&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And now you can proceed with the NIC configuration. Will ask for confirmation prior to commit any changes you made in the VSA network configuration.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000-2-2010-04-09-00-28-32.png&quot;&gt;&lt;img src=&quot;/images/p4000-2-2010-04-09-00-28-32.png&quot; alt=&quot;VSA Network settings&quot; title=&quot;VSA Network settings&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In the next area of the main menu, Network TCP Status, the speed of the network card can be forced to 1000MBs Full Duplex and the Frame Size can be set.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa-2010-04-05-01-32-15.png&quot;&gt;&lt;img src=&quot;/images/vsa-2010-04-05-01-32-15.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The final part is for group management configuration, in fact to remove the VSA from a management group, and to reset the VSA to its defaults settings.&lt;/p&gt;

&lt;p&gt;Now we have our P4000 configured to be managed through CMC. I will not explain the CMC installation since it’s just an almost &lt;em&gt;next -&amp;gt; next&lt;/em&gt; task.&lt;/p&gt;

&lt;h3 id=&quot;second-step---vsa-management-with-centralized-management-console&quot;&gt;Second step - VSA management with Centralized Management Console.&lt;/h3&gt;

&lt;p&gt;Launch the CMC. The &lt;strong&gt;Find Nodes Wizard&lt;/strong&gt; will pop-up.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/find_node_wizard.png&quot;&gt;&lt;img src=&quot;/images/find_node_wizard.png&quot; alt=&quot;Find nodes wizard&quot; title=&quot;Find nodes wizard&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Choose the appropriate option in the next screen. To add a single VSA choose the second one.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/lefthand_02.png&quot;&gt;&lt;img src=&quot;/images/lefthand_02.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Enter the IP address of the appliance.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/lefthand_08.png&quot;&gt;&lt;img src=&quot;/images/lefthand_08.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Click &lt;strong&gt;Finish&lt;/strong&gt; and if the VSA is online the wizard will find it and add it to the CMC.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/lefthand_06.png&quot;&gt;&lt;img src=&quot;/images/lefthand_06.png&quot; alt=&quot;VSA Added to CMC&quot; title=&quot;VSA Added to CMC&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Now the VSA is managed through the CMC but it is not part of a management group.&lt;/p&gt;

&lt;h3 id=&quot;step-three---add-more-storage&quot;&gt;Step Three - Add more storage.&lt;/h3&gt;

&lt;p&gt;The first basic tasks we’re going to do with the VSA prior to Management Creation is to add more storage.&lt;/p&gt;

&lt;p&gt;As the VSA is a virtual machine go to VMware Workstation or vSphere Client, depends on which VSA version are you using, and edit the appliance settings.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000_add-new-disk_1.png&quot;&gt;&lt;img src=&quot;/images/p4000_add-new-disk_1.png&quot; alt=&quot;Add new disk&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you look into the advanced configuration of the third disk, the 7.2GB one, you will see that it has the 1:0 SCSI address.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000_add-new-disk_2.png&quot;&gt;&lt;img src=&quot;/images/p4000_add-new-disk_2.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is very important because the new disks must be added sequentially from 1:1 through 1:4 addresses in order to be detected by the VSA. If there is disk added to the VSA the 1:0 SCSI address must be used for the first disk.&lt;/p&gt;

&lt;p&gt;Add the new disk and before finishing the process edit the advanced settings of the disk and set the SCSI address.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000_add-new-disk_8.png&quot;&gt;&lt;img src=&quot;/images/p4000_add-new-disk_8.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Now in the CMC go to the storage configuration. You will see the new disks as uninitialized.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000_add-new-disk_5.png&quot;&gt;&lt;img src=&quot;/images/p4000_add-new-disk_5.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Right click on the disk and select &lt;strong&gt;Add Disk to RAID&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000_add-new-disk_6.png&quot;&gt;&lt;img src=&quot;/images/p4000_add-new-disk_6.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Next you will see the disk active and already added to the RAID.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/p4000_add-new-disk_7.png&quot;&gt;&lt;img src=&quot;/images/p4000_add-new-disk_7.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;step-four---management-group-creation&quot;&gt;Step four - Management group creation.&lt;/h3&gt;

&lt;p&gt;We’re going to create the most basic configuration possible with a P4000 VSA. One VSA in a single management group and part of a single-node cluster.&lt;/p&gt;

&lt;p&gt;From the &lt;strong&gt;Getting Started&lt;/strong&gt; screen launch the &lt;strong&gt;Management Groups, Clusters and Volume Wizard&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/cluster_wizard.png&quot;&gt;&lt;img src=&quot;/images/cluster_wizard.png&quot; alt=&quot;Cluster Wizard&quot; title=&quot;Cluster Wizard&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Select &lt;strong&gt;New Management Group&lt;/strong&gt; and enter the data of the new group.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster4.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster4.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Add the administrative user.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster5.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster5.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Set the time of the Management Group.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster6.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster6.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Create a new Standard Cluster.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster7.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster7.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Enter the name of the cluster and select the nodes of the cluster, in this particular set-up there is only one node.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster8.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster8.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Finally add a virtual IP for the cluster.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster14.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster14.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Once the cluster is created the wizard will ask to create a volume. The volume can also be added later to the cluster.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster10.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster10.png&quot; alt=&quot;&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After we click finish the management group and the cluster will be created.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/vsa_cluster13.png&quot;&gt;&lt;img src=&quot;/images/vsa_cluster13.png&quot; alt=&quot;&quot; title=&quot;VSA_cluster13&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And we are done. In the next post about the P4000 I will show how to add and iSCSI volume to an ESXi4 server.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/storage/virtualization/first-hands-on-with-the-hp-lefthand-p4000-vsa/&quot;&gt;First hands-on with the HP Lefthand P4000 VSA&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on April 09, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[New HP-UX release, new HPVM, new features... same odd naming convention]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/new-hp-ux-release-new-hpvm-new-features-same-odd-naming-convention/" />
  <id>/hp-ux/new-hp-ux-release-new-hpvm-new-features-same-odd-naming-convention</id>
  <published>2010-04-06T15:19:09+02:00</published>
  <updated>2010-04-06T15:19:09+02:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Last month HP released the last update of HP-UX 11iv3, the Update 6 or the March 2010 Update or 11.36… I decided some time ago to do not try to understand why we have a so stupid naming scheme for HP-UX.&lt;/p&gt;

&lt;p&gt;Anyway, putting aside the philosophical rambling, HP-UX 11iv3 update 6 is here and it came full of &lt;a href=&quot;http://bizsupport1.austin.hp.com/bc/docs/support/SupportManual/c02023869/c02023869.pdf&quot;&gt;new features&lt;/a&gt;. The following ones stand out, at least for me.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Improved system boot time thanks to RCEnhancement, &lt;a href=&quot;http://omasse.blogspot.com/2010/03/hp-ux-11iv6-will-include-parallel-rc.html&quot;&gt;Oliver&lt;/a&gt; wrote about it several weeks ago, until this release it was available in the &lt;a href=&quot;https://h20392.www2.hp.com/portal/swdepot/displayProductInfo.do?productNumber=RCEnh&quot;&gt;Software Depot&lt;/a&gt; and now is included in the install media.&lt;/li&gt;
  &lt;li&gt;New DRD version capable of synchronize the clone with the running system.&lt;/li&gt;
  &lt;li&gt;LVM updated to version 2.2. With this version we have logical volume snapshots, can’t wait to try this :-D, logical volume migration within the same VG through the new &lt;em&gt;lvmove&lt;/em&gt; command and boot support for LVM 2.2 volume groups, this is very cool because until this release &lt;code&gt;vg00&lt;/code&gt; was stuck in LVM 1.0. Ignite-UX have also been updated to take advantage of this feature and we’ll be asked to choose between LVM 1.0 and LVM 2.2 bootable volume groups.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This release comes bundled with the new HPVM version, the 4.2, which also adds a bunch of &lt;a href=&quot;http://bizsupport2.austin.hp.com/bc/docs/support/SupportManual/c02023907/c02023907.pdf&quot;&gt;new features&lt;/a&gt;. To name a few.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Automatic memory reallocation.&lt;/li&gt;
  &lt;li&gt;Capacity of suspend and resume a guest.&lt;/li&gt;
  &lt;li&gt;Support for CVM/CFS backing stores for HPVM Serviceguard cluster packages.&lt;/li&gt;
  &lt;li&gt;Encryption of the data during Online VM migration.&lt;/li&gt;
  &lt;li&gt;AVIO support for Veritas Volume Manager based backing stores.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In short, there are a lot of new interesting features, a lot issues have also been fixed and as I said at the beginning we still have to live with an odd naming scheme but in the end I’m quite happy with this new release at least in theory because I didn’t have the opportunity to try it yet but I will do very soon since I’m planning to deploy HPVM 4.2 in the near future. In fact my HPVM 3.5 to 4.1 migration project has become a 3.5 to 4.2 migration, how cool is that eh! ;-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/new-hp-ux-release-new-hpvm-new-features-same-odd-naming-convention/&quot;&gt;New HP-UX release, new HPVM, new features... same odd naming convention&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on April 06, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[OpenVZ in CentOS 5.4]]></title>
  <link rel="alternate" type="text/html" href="/linux/virtualization/openvz-in-centos-5-4/" />
  <id>/linux/virtualization/openvz-in-centos-5-4</id>
  <published>2010-04-04T23:24:13+02:00</published>
  <updated>2010-04-04T23:24:13+02:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;First something I completely forgot in my first post. I discovered OpenVZ thanks to &lt;a href=&quot;http://vivekgite.com/&quot;&gt;Vivek Gite’s&lt;/a&gt; great site &lt;a href=&quot;http://www.cyberciti.biz/&quot;&gt;nixCraft&lt;/a&gt;. This post and the previous one are inspired by his nice series of posts about OpenVZ. Now the show can begin :-)&lt;/p&gt;

&lt;p&gt;As I said in my first post about OpenVZ I decided to set-up a test server. Since I didn’t had a spare box in my homelab I created a VM inside VMware Workstation, the performance isn’t the same as in a physical server but this a test and learn environment so it will suffice.&lt;/p&gt;

&lt;p&gt;There is a Debian based bare-metal installer ISO named &lt;a href=&quot;http://pve.proxmox.com/wiki/Downloads&quot;&gt;&lt;strong&gt;Proxmos Virtual Environment&lt;/strong&gt;&lt;/a&gt; and OpenVZ is also supported in many Linux distributions, each one has its own installation method, but I choose CentOS for my Host node server because is one of my favorite Linux server distros.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add the &lt;code&gt;yum&lt;/code&gt; repository to the server:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz ~]# cd /etc/yum.repos.d/
[root@openvz yum.repos.d]# ls
CentOS-Base.repo  CentOS-Media.repo
[root@openvz yum.repos.d]#  wget http://download.openvz.org/openvz.repo
--2010-04-04 00:53:12--  http://download.openvz.org/openvz.repo
Resolving download.openvz.org... 64.131.90.11
Connecting to download.openvz.org|64.131.90.11|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3182 (3.1K) [text/plain]
Saving to: `openvz.repo&amp;#39;

100%[==========================================================================================&amp;gt;] 3,182       --.-K/s   in 0.1s    

2010-04-04 00:53:14 (22.5 KB/s) - `openvz.repo&amp;#39; saved [3182/3182]

[root@openvz yum.repos.d]# rpm --import http://download.openvz.org/RPM-GPG-Key-OpenVZ
[root@openvz yum.repos.d]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Install the OpenVZ kernel, in my particular case I used the basic kernel but there are SMP+PAE, PAE and Xen kernels available:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz yum.repos.d]# yum install ovzkernel
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * addons: ftp.dei.uc.pt
 * base: ftp.dei.uc.pt
 * extras: ftp.dei.uc.pt
 * openvz-kernel-rhel5: openvz.proserve.nl
 * openvz-utils: openvz.proserve.nl
 * updates: ftp.dei.uc.pt
addons                                                                                                       |  951 B     00:00     
base                                                                                                         | 2.1 kB     00:00     
extras                                                                                                       | 2.1 kB     00:00     
openvz-kernel-rhel5                                                                                          |  951 B     00:00     
openvz-utils                                                                                                 |  951 B     00:00     
updates                                                                                                      | 1.9 kB     00:00     
Setting up Install Process
Resolving Dependencies
--&amp;gt; Running transaction check
---&amp;gt; Package ovzkernel.i686 0:2.6.18-164.15.1.el5.028stab068.9 set to be installed
--&amp;gt; Finished Dependency Resolution

Dependencies Resolved

====================================================================================================================================
 Package                 Arch               Version                                         Repository                         Size
====================================================================================================================================
Installing:
 ovzkernel               i686               2.6.18-164.15.1.el5.028stab068.9                openvz-kernel-rhel5                19 M

Transaction Summary
====================================================================================================================================
Install      1 Package(s)         
Update       0 Package(s)         
Remove       0 Package(s)         

Total download size: 19 M
Is this ok [y/N]: y
Downloading Packages:
ovzkernel-2.6.18-164.15.1.el5.028stab068.9.i686.rpm                                                          |  19 MB     00:19     
Running rpm_check_debug
Running Transaction Test
Finished Transaction Test
Transaction Test Succeeded
Running Transaction
 Installing     : ovzkernel                                                                                                    1/1

Installed:
 ovzkernel.i686 0:2.6.18-164.15.1.el5.028stab068.9                                                                                 

Complete!
[root@openvz yum.repos.d]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Install OpenVZ management utilities:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz yum.repos.d]# yum install vzctl vzquota
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * addons: centos.cict.fr
 * base: ftp.dei.uc.pt
 * extras: centos.cict.fr
 * openvz-kernel-rhel5: mirrors.ircam.fr
 * openvz-utils: mirrors.ircam.fr
 * updates: ftp.dei.uc.pt
Setting up Install Process
Resolving Dependencies
--&amp;gt; Running transaction check
---&amp;gt; Package vzctl.i386 0:3.0.23-1 set to be updated
--&amp;gt; Processing Dependency: vzctl-lib = 3.0.23-1 for package: vzctl
--&amp;gt; Processing Dependency: libvzctl-0.0.2.so for package: vzctl
---&amp;gt; Package vzquota.i386 0:3.0.12-1 set to be updated
--&amp;gt; Running transaction check
---&amp;gt; Package vzctl-lib.i386 0:3.0.23-1 set to be updated
--&amp;gt; Finished Dependency Resolution

Dependencies Resolved

====================================================================================================================================
 Package                         Arch                       Version                        Repository                          Size
====================================================================================================================================
Installing:
 vzctl                           i386                       3.0.23-1                       openvz-utils                       143 k
 vzquota                         i386                       3.0.12-1                       openvz-utils                        82 k
Installing for dependencies:
 vzctl-lib                       i386                       3.0.23-1                       openvz-utils                       175 k

Transaction Summary
====================================================================================================================================
Install      3 Package(s)         
Update       0 Package(s)         
Remove       0 Package(s)         

Total download size: 400 k
Is this ok [y/N]: y
Downloading Packages:
(1/3): vzquota-3.0.12-1.i386.rpm                                                                             |  82 kB     00:00     
(2/3): vzctl-3.0.23-1.i386.rpm                                                                               | 143 kB     00:00     
(3/3): vzctl-lib-3.0.23-1.i386.rpm                                                                           | 175 kB     00:00     
------------------------------------------------------------------------------------------------------------------------------------
Total                                                                                               201 kB/s | 400 kB     00:01     
Running rpm_check_debug
Running Transaction Test
Finished Transaction Test
Transaction Test Succeeded
Running Transaction
 Installing     : vzctl-lib                                                                                                    1/3
 Installing     : vzquota                                                                                                      2/3
 Installing     : vzctl                                                                                                        3/3

Installed:
 vzctl.i386 0:3.0.23-1                                           vzquota.i386 0:3.0.12-1                                          

Dependency Installed:
 vzctl-lib.i386 0:3.0.23-1                                                                                                         

Complete!
[root@openvz yum.repos.d]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Configure the kernel. The following adjustments must be done in the &lt;code&gt;/etc/sysctl.conf&lt;/code&gt; file:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;# On Hardware Node we generally need
# packet forwarding enabled and proxy arp disabled
net.ipv4.ip_forward = 1
net.ipv6.conf.default.forwarding = 1
net.ipv6.conf.all.forwarding = 1
net.ipv4.conf.default.proxy_arp = 0

# Enables source route verification
net.ipv4.conf.all.rp_filter = 1

# Enables the magic-sysrq key
kernel.sysrq = 1

# We do not want all our interfaces to send redirects
net.ipv4.conf.default.send_redirects = 1
net.ipv4.conf.all.send_redirects = 0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Disable SELinux:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz ~]# cat /etc/sysconfig/selinux   
# This file controls the state of SELinux on the system.
# SELINUX= can take one of these three values:
#       enforcing - SELinux security policy is enforced.
#       permissive - SELinux prints warnings instead of enforcing.
#       disabled - SELinux is fully disabled.
SELINUX=disabled
# SELINUXTYPE= type of policy in use. Possible values are:
#       targeted - Only targeted network daemons are protected.
#       strict - Full SELinux protection.
SELINUXTYPE=targeted

# SETLOCALDEFS= Check local definition changes
SETLOCALDEFS=0
[root@openvz ~]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Reboot the sever with the new kernel.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/images/openvz-2010-04-04-23-05-08.png&quot;&gt;&lt;img src=&quot;/images/openvz-2010-04-04-23-05-08.png&quot; alt=&quot;OpenVZ kernel boot&quot; title=&quot;OpenVZ kernel boot&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Check OpenVZ service:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz ~]# chkconfig --list vz
vz              0:off   1:off   2:on    3:on    4:on    5:on    6:off
[root@openvz ~]# service vz status
OpenVZ is running...
[root@openvz ~]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The first part is over, now we are going to create a VPS as a proof of concept.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Download the template of the Linux distribution to install as VPS and place it in &lt;code&gt;/vz/template/cache&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz /]# cd vz/template/cache/
[root@openvz cache]# wget http://download.openvz.org/template/precreated/centos-5-x86.tar.gz
--2010-04-04 23:20:20--  http://download.openvz.org/template/precreated/centos-5-x86.tar.gz
Resolving download.openvz.org... 64.131.90.11
Connecting to download.openvz.org|64.131.90.11|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 179985449 (172M) [application/x-gzip]
Saving to: `centos-5-x86.tar.gz&amp;#39;

100%[==========================================================================================&amp;gt;] 179,985,449  987K/s   in 2m 58s  

2010-04-04 23:23:19 (988 KB/s) - `centos-5-x86.tar.gz&amp;#39; saved [179985449/179985449]

[root@openvz cache]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Create a new virtual machine using the template.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz cache]# vzctl create 1 --ostemplate centos-5-x86
Creating container private area (centos-5-x86)
Performing postcreate actions
Container private area was created
[root@openvz cache]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;We have a basic VPS created but it needs more tweaking before we can start it. Set the IP address, the DNS server, hostname, a name to identify it in the Host node and finally set the On Boot parameter to automatically start the container with the host.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz cache]# vzctl set 1 --ipadd 192.168.1.70 --save
Saved parameters for CT 1
[root@openvz cache]# vzctl set 1 --name vps01 --save
Name vps01 assigned
Saved parameters for CT 1
[root@openvz cache]# vzctl set 1 --hostname vps01 --save
Saved parameters for CT 1
[root@openvz cache]# vzctl set 1 --nameserver 192.168.1.1 --save
Saved parameters for CT 1
[root@openvz cache]# vzctl set 1 --onboot yes --save
 Saved parameters for CT 1
[root@openvz cache]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Start the container and check it with &lt;code&gt;vzlist&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz cache]# vzctl start vps01
Starting container ...
Container is mounted
Adding IP address(es): 192.168.1.70
Setting CPU units: 1000
Configure meminfo: 65536
Set hostname: vps01
File resolv.conf was modified
Container start in progress...
[root@openvz cache]#
[root@openvz cache]#
[root@openvz cache]# vzlist
 CTID      NPROC STATUS  IP_ADDR         HOSTNAME                        
 1         10 running 192.168.1.70    vps01                           
[root@openvz cache]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Enter the container and check that its operating system is up and running.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz cache]# vzctl enter vps01
entered into CT 1
[root@vps01 /]#
[root@vps01 /]# free -m
 total       used       free     shared    buffers     cached
Mem:           256          8        247          0          0          0
-/+ buffers/cache:          8        247
Swap:            0          0          0
[root@vps01 /]# uptime
 02:02:11 up 8 min,  0 users,  load average: 0.00, 0.00, 0.00
[root@vps01 /]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;To finish the test stop the container.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@openvz /]# vzctl stop 1
Stopping container ...
Container was stopped
Container is unmounted
[root@openvz /]#
[root@openvz /]# vzlist -a
 CTID      NPROC STATUS  IP_ADDR         HOSTNAME                        
 1          - stopped 192.168.1.70    vps01                           
[root@openvz /]#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And as I like to say… we are done ;-) Next time will try to cover more advanced topics.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/linux/virtualization/openvz-in-centos-5-4/&quot;&gt;OpenVZ in CentOS 5.4&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on April 04, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Linux container-based virtualization with OpenVZ]]></title>
  <link rel="alternate" type="text/html" href="/linux/virtualization/linux-container-based-virtualization-with-openvz/" />
  <id>/linux/virtualization/linux-container-based-virtualization-with-openvz</id>
  <published>2010-04-04T22:07:53+02:00</published>
  <updated>2010-04-04T22:07:53+02:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Long time since my last post. I’ve been on holidays! :-D&lt;/p&gt;

&lt;p&gt;But don’t worry my dear readers, I did not fall into laziness and the few times I wasn’t playing with my son I’ve been playing in my homelab with other virtualization technologies, storage appliances, my ESXi servers… what can I say I’m a Geek. One of the most interesting technologies I’ve been playing with is &lt;strong&gt;OpenVZ&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://wiki.openvz.org/Main_Page&quot; title=&quot;OpenVZ Wiki&quot;&gt;OpenVZ&lt;/a&gt;is a container-based operating system-level virtualization technology for Linux, if you have ever worked with Solaris 10 Zones this is very similar. The OpenVZ project is supported by Parallels which also have based their commercial solution Virtuozzo on OpenVZ.&lt;/p&gt;

&lt;p&gt;OpenVZ (and other container-based technologies) differs with other technologies like VMware or HPVM in that the last ones virtualize the entire machine with its own OS, disks, ram, etc. OpenVZ on the contrary use only one Linux kernel and create multiple isolated instances. of course there are pros and cons, just to name a couple:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;VMware, HPVM and other true hypervisors are more flexible since many different operative systems can be run on top of them, OpenVZ on the contrary can only run Linux instances.&lt;/li&gt;
  &lt;li&gt;OpenVZ since it is not a real hypervisor does not have their overhead so it is very fast.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;glossary-of-terms&quot;&gt;Glossary of terms&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Host node, CTo, VEo: The host where the containers run.&lt;/li&gt;
  &lt;li&gt;VPS, VE: The containers themselves. One Host node can run multiple VPS and each VPS can run a different Linux distribution such as Gentoo, Ubuntu, CentOS, etc, but every VPS operate under the same Linux kernel.&lt;/li&gt;
  &lt;li&gt;CTID: ConTainer’s IDentifier. A unique number that every VPS has and used to manage it.&lt;/li&gt;
  &lt;li&gt;Beancounters: The beancounters, also known as UBC Parameter Units, are nothing but a set of limits defined by the system administrator. The beancounters assure that no VPS can abuse the resources of the Host node. The whole list of Beancounter is described in detail in the &lt;a href=&quot;http://wiki.openvz.org/UBC_parameter_units&quot; title=&quot;OpenVZ UBC Parameter Units&quot;&gt;OpenVZ wiki&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;VPS templates: The templates are the images used to create new containers.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;openvz-directory-structure&quot;&gt;OpenVZ directory structure&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;/vz&lt;/code&gt; - The default main directory.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;/vz/private&lt;/code&gt; - Where the VPS are stored.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;/vz/template/cache&lt;/code&gt; - In this path are stored the templates for the
different Linux distributions.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;/etc/vz&lt;/code&gt; - Configuration directory for OpenVZ.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;/etc/vz/vz.conf&lt;/code&gt; - OpenVZ configuration file.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;resource-management&quot;&gt;Resource management&lt;/h3&gt;

&lt;p&gt;The amount of resources from the Host node available for the Virtual Environments can be managed through four different ways.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Two-Level Disk Quota: The administrator of the Host node can set-up disk quotas for each  container.&lt;/li&gt;
  &lt;li&gt;Fair CPU scheduler: It is a two-level scheduler with a first level scheduler deciding which container is given the CPU time slice and on the second level the standard Linux scheduler decides which process to run in that container.&lt;/li&gt;
  &lt;li&gt;I/O scheduler: Very similar to the CPU scheduler, is also a two-level scheduler. Priorities are assigned to each container and the I/O scheduler distributes the available bandwidth according to those priorities.&lt;/li&gt;
  &lt;li&gt;User Beancounters.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I’m now in the process of set-up an OpenVZ test server in my homelab so I will try to cover some of its features more in depth in a future post.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/linux/virtualization/linux-container-based-virtualization-with-openvz/&quot;&gt;Linux container-based virtualization with OpenVZ&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on April 04, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Guest migration in HPVM 3.5]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/itanium/sysadmin/virtualization/guest-migration-in-hpvm-3-5/" />
  <id>/hp-ux/itanium/sysadmin/virtualization/guest-migration-in-hpvm-3-5</id>
  <published>2010-03-24T15:25:16+01:00</published>
  <updated>2010-03-24T15:25:16+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;As I already said many times my current HPVM version is 3.5 so it doesn’t support guest online migration. But lacking the online migration feature doesn’t mean that we can not perform Integrity VM migration between hosts.&lt;/p&gt;

&lt;p&gt;Currently there are two methods to perform migrations:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;HPVM commands.&lt;/li&gt;
  &lt;li&gt;MC/ServiceGuard.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In this post I will only cover the HPVM way. I will leave HPVM ServiceGuard clusters for a future post but as many of you already know moving a guest between cluster nodes is like moving any other ServiceGuard package since the guests are managed by SG as packages.&lt;/p&gt;

&lt;h3 id=&quot;prerequisites&quot;&gt;PREREQUISITES&lt;/h3&gt;

&lt;p&gt;There is a certain list of prerequisites the guest has to met in order to be successfully migrated between hosts.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Off-line state:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This is pretty obvious of course, the guest must be off.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;SSH configuration:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In both hosts root must have SSH access through public key authentication to the other.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivmcl01:~ # hpvmmigrate -P hpvm1 -h ivmcl02
hpvmmigrate: SSH execution error. Make sure ssh is setup right on both source and target systems.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Shared devices:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If the guest has a shared device like the CD/DVD of the host, the device has to be deleted from the guest configuration.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivmcl01:~ # hpvmmigrate -P hpvm1 -h ivmcl02
hpvmmigrate: Device /dev/rdsk/c1t4d0 is shared.  Guest with shared storage devices cannot be migrated.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Storage devices:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There are two consideration about storage devices.&lt;/p&gt;

&lt;p&gt;The storage devices of the guest must be physical disks. Migration of guests with lvols as storage devices is supported only in &lt;a href=&quot;http://h20000.www2.hp.com/bizsupport/TechSupport/CoreRedirect.jsp?redirectReason=DocIndexPDF&amp;amp;prodSeriesId=4146132&amp;amp;targetPage=http%3A%2F%2Fbizsupport1.austin.hp.com%2Fbc%2Fdocs%2Fsupport%2FSupportManual%2Fc02018680%2Fc02018680.pdf&quot; title=&quot;HPVM 4.1 Release Notes&quot;&gt;HPVM 4.1&lt;/a&gt; release.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivmcl01:~ # hpvmmigrate -P hpvm1 -h ivmcl02
hpvmmigrate: Target VM Host error - Device does not exist.
hpvmmigrate: See HPVM command log file on target VM Host for more detail.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The WWID of the device must be the same in both HPVM hosts.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivmcl01:~ # hpvmmigrate -P hpvm1 -h ivmcl02
hpvmmigrate: Device WWID does not match.
hpvmmigrate: See HPVM command log file on target VM Host for more detail.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Network configuration:&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The virtual switch where the guest is connected to must be configured on the same network card in both hosts. For example if vSwitch &lt;code&gt;vlan2&lt;/code&gt; is using &lt;code&gt;lan0&lt;/code&gt; in host1 then it must be using &lt;code&gt;lan0&lt;/code&gt; in host2 or the migration will fail.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivmcl01:~ # hpvmmigrate -P hpvm1 -h ivmcl02
hpvmmigrate: Target VM Host error - vswitch validation failed.
hpvmmigrate: See HPVM command log file on target VM Host for more detail.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;procedure&quot;&gt;PROCEDURE&lt;/h3&gt;

&lt;p&gt;If all the prerequisites explained before are met by our guest we can proceed with the migration. The command to use is &lt;code&gt;hpvmmigrate&lt;/code&gt;, the name or the VM number and the hostname of the destination server have to be provided. Some of the resources of the virtual machines like number of CPU, amount of RAM or the machine label can also be modified.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivmcl01:~ # hpvmmigrate -P hpvm1 -h ivmcl02
hpvmmigrate: Guest migrated successfully.
root@ivmcl01:~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Check the existence of the migrated guest in the destination host.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivmcl02:~ # hpvmstatus
[Virtual Machines]
Virtual Machine Name VM #  OS Type State     #VCPUs #Devs #Nets Memory  Runsysid
==================== ===== ======= ========= ====== ===== ===== ======= ========
oratest01                1 HPUX    On (OS)        4    10     3   16 GB        0
oratest02                2 HPUX    On (OS)        4     8     3   16 GB        0
sapvm01                  3 HPUX    Off            3     8     3    8 GB        0
sapvm02                  4 HPUX    Off            3     7     3    8 GB        0
sles01                   5 LINUX   On (OS)        1     4     3    4 GB        0
rhel01                   6 LINUX   Off            1     4     3    4 GB        0
hp-vxvm                  7 HPUX    On (OS)        2    17     3    6 GB        0
ws2003                   8 WINDOWS Off            4     4     3   12 GB        0
hpvm1                   10 HPUX    Off            1     1     1    3 GB        0
root@ivmcl02:~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;As you can see once all the prerequisites have been met the migration is quite easy.&lt;/p&gt;

&lt;h3 id=&quot;conclusion&quot;&gt;CONCLUSION&lt;/h3&gt;

&lt;p&gt;Even with the disadvantage of lacking online migration the guest migration feature can be of usefulness to balance the load between HPVM hosts.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/itanium/sysadmin/virtualization/guest-migration-in-hpvm-3-5/&quot;&gt;Guest migration in HPVM 3.5&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on March 24, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[HPVM clones first boot tasks]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/itanium/sysadmin/virtualization/hpvm-clones-first-boot-tasks/" />
  <id>/hp-ux/itanium/sysadmin/virtualization/hpvm-clones-first-boot-tasks</id>
  <published>2010-03-17T12:47:40+01:00</published>
  <updated>2010-03-17T12:47:40+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Welcome again to &lt;strong&gt;HPVM World!&lt;/strong&gt; my dear readers :-D&lt;/p&gt;

&lt;p&gt;Have to say that even with the initial disappointment about &lt;code&gt;hpvmclone&lt;/code&gt;, cloning IVMs was a very funny task but I believe that the after cloning tasks weren’t very clear, at least for me, so I decided to write this follow up post to clarify that part.&lt;/p&gt;

&lt;p&gt;Let’s assume we already have a cloned virtual machine, in this particular case I used &lt;code&gt;dd&lt;/code&gt; to clone the virtual disk and later I created the IVM and added the storage device and the other resources but it also applied to the other method with minor changes.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmstatus -P vmnode2 -d
[Virtual Machine Devices]

[Storage Interface Details]
disk:scsi:0,0,0:lv:/dev/vg_vmtest/rvmnode2disk
dvd:scsi:0,0,1:disk:/dev/rdsk/c1t4d0

[Network Interface Details]
network:lan:0,1,0xB20EBA14E76C:vswitch:localnet
network:lan:0,2,0x3E9492C9F615:vswitch:vlan02

[Misc Interface Details]
serial:com1::tty:console
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We start the virtual machine an access its console.Now we are going to follow some of the final steps of the third method described in my previous post. From the main &lt;code&gt;EFI Boot Manager&lt;/code&gt; select the &lt;code&gt;Boot option maintenance menu&lt;/code&gt; option.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Manager ver 1.10 [14.62] [Build: Mon Oct  1 09:27:26 2007]

Please select a boot option

     EFI Shell [Built-in]                                           
     Boot option maintenance menu                                    

     Use ^ and v to change option(s). Use Enter to select an option&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Select Boot from a file and the select the first partition:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Maintenance Manager ver 1.10 [14.62]

Boot From a File.  Select a Volume

    IA64_EFI [Acpi(PNP0A03,0)/Pci(0|0)/Scsi(Pun0,Lun0)/HD(Part1,Sig
    IA64_EFI [Acpi(PNP0A03,0)/Pci(0|0)/Scsi(Pun0,Lun0)/HD(Part3,Sig7
    Removable Media Boot [Acpi(PNP0A03,0)/Pci(0|0)/Scsi(Pun1,Lun0)]
    Load File [Acpi(PNP0A03,0)/Pci(1|0)/Mac(B20EBA14E76C)]          
    Load File [Acpi(PNP0A03,0)/Pci(2|0)/Mac(3E9492C9F615)]        
    Load File [EFI Shell [Built-in]]                                
    Legacy Boot
    Exit&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Enter the EFI directory then the HPUX directory and finally select &lt;code&gt;hpux.file&lt;/code&gt;. Like I said before this part is very similar to the final steps of Method 3.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Maintenance Manager ver 1.10 [14.62]

Select file or change to new directory:

       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 .                         
       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 ..                        
       03/10/10  04:21p           657,609 hpux.efi                  
       03/09/10  03:45p            24,576 nbp.efi                   
       Exit&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After this the machine will boot.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Filename: \EFI\HPUX\hpux.efi
 DevicePath: [Acpi(PNP0A03,0)/Pci(0|0)/Scsi(Pun0,Lun0)/HD(Part1,Sig71252358-2BCD-11DF-8000-D6217B60E588)/\EFI\HPUX\hpux.efi]
   IA-64 EFI Application 03/10/10  04:21p     657,609 bytes

(C) Copyright 1999-2008 Hewlett-Packard Development Company, L.P.
All rights reserved

HP-UX Boot Loader for IPF  --  Revision 2.036

Press Any Key to interrupt Autoboot
\EFI\HPUX\AUTO ==&amp;gt; boot vmunix
Seconds left till autoboot -   0
AUTOBOOTING...&amp;gt; System Memory = 2042 MB
loading section 0
..................................................................................... (complete)
loading section 1
............... (complete)
loading symbol table
loading System Directory (boot.sys) to MFS
.....
loading MFSFILES directory (bootfs) to MFS
..................
Launching /stand/vmunix
SIZE: Text:43425K + Data:7551K + BSS:22118K = Total:73096K
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;When the VM is up login as root. The first tasks as always are to change hostname and network configuration to avoid conflicts.&lt;/p&gt;

&lt;p&gt;Next we are going recreate &lt;code&gt;lvmtab&lt;/code&gt; since the current one contains the LVM configuration of the source virtual machine. Performing a simple &lt;code&gt;vgdisplay&lt;/code&gt; will show it.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@vmnode2:/# vgdisplay
vgdisplay: Warning: couldn&amp;#39;t query physical volume &amp;quot;/dev/disk/disk15_p2&amp;quot;:
The specified path does not correspond to physical volume attached to
this volume group
vgdisplay: Warning: couldn&amp;#39;t query all of the physical volumes.
--- Volume groups ---
VG Name                     /dev/vg00
VG Write Access             read/write     
VG Status                   available                 
Max LV                      255    
Cur LV                      8      
Open LV                     8      
Max PV                      16     
Cur PV                      1      
Act PV                      0      
Max PE per PV               3085         
VGDA                        0   
PE Size (Mbytes)            8               
Total PE                    0       
Alloc PE                    0       
Free PE                     0       
Total PVG                   0        
Total Spare PVs             0              
Total Spare PVs in use      0

root@vmnode2:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To correct this remove the &lt;code&gt;/etc/lvmtab&lt;/code&gt; file and execute a new &lt;code&gt;vgscan&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@vmnode2:/# rm /etc/lvmtab
/etc/lvmtab: ? (y/n) y
root@vmnode2:/var/tmp/software# vgscan
Creating &amp;quot;/etc/lvmtab&amp;quot;.
vgscan: Couldn&amp;#39;t access the list of physical volumes for volume group &amp;quot;/dev/vg00&amp;quot;.
Physical Volume &amp;quot;/dev/dsk/c1t1d0&amp;quot; contains no LVM information

*** LVMTAB has been created successfully.
*** Do the following to resync the information on the disk.
*** #1.  vgchange -a y
*** #2.  lvlnboot -R
root@vmnode2:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Follow the recommended steps in &lt;code&gt;vgscan&lt;/code&gt; output, the first step only applies if there are any other VGs in the system, if there is only &lt;code&gt;vg00&lt;/code&gt; it is already active so this step is not necessary.&lt;/p&gt;

&lt;p&gt;Running &lt;code&gt;lvnlboot -R&lt;/code&gt; is mandatory since we need to recover and update the links to the logical volumes in the Boot Data Reserved Area of the booting disk.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@vmnode2:/# lvlnboot -R
Volume Group configuration for /dev/vg00 has been saved in /etc/lvmconf/vg00.conf
root@vmnode2:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now the LVM configuration is fixed, try again the &lt;code&gt;vgdisplay&lt;/code&gt; command.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@vmnode2:/# vgdisplay
--- Volume groups ---
VG Name                     /dev/vg00
VG Write Access             read/write
VG Status                   available
Max LV                      255
Cur LV                      8
Open LV                     8
Max PV                      16
Cur PV                      1
Act PV                      1
Max PE per PV               3085
VGDA                        2
PE Size (Mbytes)            8
Total PE                    3075
Alloc PE                    2866
Free PE                     209
Total PVG                   0
Total Spare PVs             0
Total Spare PVs in use      0

root@vmnode2:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;With the LVM configuration fixed the next step is to indicate the booting disk to the system.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@vmnode2:/# setboot -p /dev/disk/disk21_p2
Primary boot path set to 0/0/0/0.0x0.0x0 (/dev/disk/disk21_p2)
root@vmnode2:/#
root@vmnode2:/# setboot
Primary bootpath : 0/0/0/0.0x0.0x0 (/dev/rdisk/disk21)
HA Alternate bootpath :
Alternate bootpath :

Autoboot is ON (enabled)
root@vmnode2:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Finally reboot the virtual machine and if we did everything correctly a new boot option will be available in &lt;strong&gt;EFI Boot Manager&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Manager ver 1.10 [14.62] [Build: Mon Oct  1 09:27:26 2007]

Please select a boot option

    HP-UX Primary Boot: 0/0/0/0.0x0.0x0                             
    EFI Shell [Built-in]                                            
    Boot option maintenance menu                                    

    Use ^ and v to change option(s). Use Enter to select an option&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Let the system boot by itself through the new default option &lt;code&gt;HP-UX Primary Boot&lt;/code&gt; and we are done.&lt;/p&gt;

&lt;p&gt;Any feedback would be welcome.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/itanium/sysadmin/virtualization/hpvm-clones-first-boot-tasks/&quot;&gt;HPVM clones first boot tasks&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on March 17, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Cloning HPVM guests]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/itanium/sysadmin/virtualization/cloning-hpvm-guests/" />
  <id>/hp-ux/itanium/sysadmin/virtualization/cloning-hpvm-guests</id>
  <published>2010-03-09T19:17:57+01:00</published>
  <updated>2010-03-09T19:17:57+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Our next step in the wonderful HPVM World is… cloning virtual machines.&lt;/p&gt;

&lt;p&gt;If you have used VMware Virtual Infrastructure cloning, probably are used to the easy &lt;em&gt;right-click and clone vm&lt;/em&gt; procedure. Sadly HPVM cloning has nothing in common with it. In fact the process to clone a virtual machine can be a little creepy.&lt;/p&gt;

&lt;p&gt;Of course there is a &lt;code&gt;hpvmclone&lt;/code&gt; command and anyone can think, as I did the first time I had to clone an IVM, I only have to provide the source VM, the new VM name and &lt;em&gt;voilà&lt;/em&gt; everything will be done:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmclone -P ivm1 -N ivm_clone01
[root@hpvmhost] ~ # hpvmstatus
[Virtual Machines]
Virtual Machine Name VM #  OS Type State     #VCPUs #Devs #Nets Memory  Runsysid
==================== ===== ======= ========= ====== ===== ===== ======= ========
ivm1                     9 HPUX    Off            3     3     2    2 GB        0
ivm2                    10 HPUX    Off            1     7     1    3 GB        0
ivm_clone01             11 HPUX    Off            3     3     2    2 GB        0
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The new virtual machine can be seen and everything seems to be fine but when you ask for the configuration details of the new IVM a nasty surprise will appear… the storage devices had not been cloned instead it looks that &lt;code&gt;hpvmclone&lt;/code&gt; simply mapped the devices of the source IVM to the new IVM:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmstatus -P ivm_clone01
[Virtual Machine Details]
Virtual Machine Name VM #  OS Type State
==================== ===== ======= ========
ivm_clone01             11 HPUX    Off      

[Authorized Administrators]
Oper Groups: 
Admin Groups:
Oper Users:  
Admin Users: 

[Virtual CPU Details]
#vCPUs Entitlement Maximum
====== =========== =======
     3       20.0%  100.0%

[Memory Details]
Total    Reserved
Memory   Memory 
=======  ========
   2 GB     64 MB

[Storage Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
disk    scsi         0   2   0   0   0 lv        /dev/vg_vmtest/rivm1d1
disk    scsi         0   2   0   1   0 lv        /dev/vg_vmtest/rivm1d2
dvd     scsi         0   2   0   2   0 disk      /dev/rdsk/c1t4d0

[Network Interface Details]
Interface Adaptor    Name/Num   PortNum Bus Dev Ftn Mac Address
========= ========== ========== ======= === === === =================
vswitch   lan        vlan02     11        0   0   0 f6-fb-bf-41-78-63
vswitch   lan        localnet   10        0   1   0 2a-69-35-d5-c1-5f

[Misc Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
serial  com1                           tty       console
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;With this configuration the virtual machines can’t be booted at the same time. So, what is the purpose of &lt;code&gt;hpvmclone&lt;/code&gt; if the newly cloned node can’t be used simultaneously with the original? Honestly this makes no sense at least for me.&lt;/p&gt;

&lt;p&gt;At that point and since I really wanted to use both machines in a test cluster I decided to do a little research through Google and &lt;a href=&quot;http://www.itrc.hp.com/&quot; title=&quot;IT Resource Center&quot;&gt;ITRC&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;After reading again the official documentation, a few dozens posts regarding HPVM cloning and HPVM in general and a few very nice posts in Daniel Parkes’ &lt;a href=&quot;http://www.hpuxtips.es/&quot;&gt;HP-UX Tips &amp;amp; Tricks&lt;/a&gt; site I finally came up with three different methods to successfully and &lt;em&gt;physically&lt;/em&gt; clone an Integrity Virtual Machine.&lt;/p&gt;

&lt;h3 id=&quot;method-1-using-dd&quot;&gt;METHOD 1: Using &lt;code&gt;dd&lt;/code&gt;&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Create the LVM structure for the new virtual machine on the host.&lt;/li&gt;
  &lt;li&gt;Use &lt;code&gt;dd&lt;/code&gt; to copy every storage device from the source virtual machine.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # dd if=/dev/vg_vmtest/rivm1d1 of=/dev/vg_vmtest/rclone01_d1 bs=1024k
12000+0 records in
12000+0 records out
[root@hpvmhost] ~ #
[root@hpvmhost] ~ # dd if=/dev/vg_vmtest/rivm1d2 of=/dev/vg_vmtest/rclone01_d2 bs=1024k
12000+0 records in
12000+0 records out
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Using &lt;code&gt;hpvmclone&lt;/code&gt; create the new machine and in the same command add the new storage devices and delete the old ones from its configuration, any resource can also be modified at this point like with &lt;code&gt;hpvmcreate&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmclone -P ivm1 -N clone01 -d disk:scsi:0,2,0:lv:/dev/vg_vmtest/rivm1d1 \
&amp;gt; -d disk:scsi:0,2,1:lv:/dev/vg_vmtest/rivm1d2 \
&amp;gt; -a disk:scsi::lv:/dev/vg_vmtest/rclone01_d1 \
&amp;gt; -a disk:scsi::lv:/dev/vg_vmtest/rclone01_d2 \
&amp;gt; -l &amp;quot;Clone-cluster 01&amp;quot; \
&amp;gt; -B manual
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Start the new virtual machine and make the necessary changes to the guest OS (network, hostname, etc).&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;method-2-clone-the-virtual-storage-devices-at-the-same-time-the-ivm-is-cloned&quot;&gt;METHOD 2: Clone the virtual storage devices at the same time the IVM is cloned.&lt;/h3&gt;

&lt;p&gt;Yes, yes and yes it can be done with &lt;code&gt;hpvmclone&lt;/code&gt;, you have to use the &lt;code&gt;-b&lt;/code&gt; switch and provide the storage resource to use.&lt;/p&gt;

&lt;p&gt;I really didn’t test this procedure with other devices apart from the booting disk/disks. In theory the man page of the command and the HPVM documentation states that this option can be used to specify the booting device of the clone but I used to clone a virtual machine with one boot disk and one with two disks and in both cases it worked without problems.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;As in METHOD 1 create the necessary LVM infrastructure for the new IVM.&lt;/li&gt;
  &lt;li&gt;Once the lvols are created clone the virtual machine.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmclone -P ivm1 -N vxcl01 -a disk:scsi::lv:/dev/vg_vmtest/rvxcl01_d1 \
&amp;gt; -a disk:scsi::lv:/dev/vg_vmtest/rvxcl01_d2 \
&amp;gt; -b disk:scsi:0,2,0:lv:/dev/vg_vmtest/rvxcl01_d1 \
&amp;gt; -b disk:scsi:0,2,1:lv:/dev/vg_vmtest/rvxcl01_d2 \
&amp;gt; -d disk:scsi:0,2,0:lv:/dev/vg_vmtest/rivm1d1 \
&amp;gt; -d disk:scsi:0,2,1:lv:/dev/vg_vmtest/rivm1d2 \
&amp;gt; -B manual
12000+0 records in
12000+0 records out
hpvmclone: Virtual storage cloned successfully.
12000+0 records in
12000+0 records out
hpvmclone: Virtual storage cloned successfully.
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Start the virtual machine.&lt;/li&gt;
  &lt;li&gt;Now log into the virtual machine to check the start-up process and to make any change needed.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;method-3-dynamic-root-disk&quot;&gt;METHOD 3: Dynamic Root Disk.&lt;/h3&gt;

&lt;p&gt;Since with DRD a clone of &lt;code&gt;vg00&lt;/code&gt; can be produced we can use it too to clone an Integrity Virtual Machine.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;First step is to create a new &lt;code&gt;lvol&lt;/code&gt; that will contain the clone of &lt;code&gt;vg00&lt;/code&gt;, it has to be at least the same size as the original disk.&lt;/li&gt;
  &lt;li&gt;Install the last DRD version supported on the virtual machin to clone.&lt;/li&gt;
  &lt;li&gt;Add the new volume to the source virtual machine and from the guest OS re-scan for the new disk.&lt;/li&gt;
  &lt;li&gt;Now proceed with the DRD clone.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivm2:~# drd clone -v -x overwrite=true -t /dev/disk/disk15   

=======  03/09/10 15:45:15 MST  BEGIN Clone System Image (user=root)  (jobid=ivm2)

       * Reading Current System Information
       * Selecting System Image To Clone
       * Converting legacy Dsf &amp;quot;/dev/dsk/c0t0d0&amp;quot; to &amp;quot;/dev/disk/disk3&amp;quot;
       * Selecting Target Disk
NOTE:    There may be LVM 2 volumes configured that will not be recognized.
       * Selecting Volume Manager For New System Image
       * Analyzing For System Image Cloning
       * Creating New File Systems
       * Copying File Systems To New System Image
       * Copying File Systems To New System Image succeeded.
       * Making New System Image Bootable
       * Unmounting New System Image Clone
       * System image: &amp;quot;sysimage_001&amp;quot; on disk &amp;quot;/dev/disk/disk15&amp;quot;

=======  03/09/10 16:05:20 MST  END Clone System Image succeeded. (user=root)  (jobid=ivm2)

root@ivm2:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Mount the new image.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivm2:~# drd mount -v

=======  03/09/10 16:09:08 MST  BEGIN Mount Inactive System Image (user=root)  (jobid=ivm2)

       * Checking for Valid Inactive System Image
       * Locating Inactive System Image
       * Preparing To Mount Inactive System Image
       * Selected inactive system image &amp;quot;sysimage_001&amp;quot; on disk &amp;quot;/dev/disk/disk15&amp;quot;.
       * Mounting Inactive System Image
       * System image: &amp;quot;sysimage_001&amp;quot; on disk &amp;quot;/dev/disk/disk15&amp;quot;

=======  03/09/10 16:09:26 MST  END Mount Inactive System Image succeeded. (user=root)  (jobid=ivm2)

root@ivm2:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;On the mounted image edit the &lt;code&gt;netconf&lt;/code&gt; file and modify the hostname to “” and remove any network configuration such as IP address, gateway, etc. The image is mounted on &lt;code&gt;/var/opt/drd/mnts/sysimage_001&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Move or delete the DRD XML registry file in &lt;code&gt;/var/opt/drd/mnts/sysimage_001/var/opt/drd/registry&lt;/code&gt; in order to avoid any problems during the boot of the clone since the source disk will not be present.&lt;/li&gt;
  &lt;li&gt;Unmount the image.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@ivm2:~# drd umount -v

=======  03/09/10 16:20:45 MST  BEGIN Unmount Inactive System Image (user=root)  (jobid=ivm2)

       * Checking for Valid Inactive System Image
       * Locating Inactive System Image
       * Preparing To Unmount Inactive System Image
       * Unmounting Inactive System Image
       * System image: &amp;quot;sysimage_001&amp;quot; on disk &amp;quot;/dev/disk/disk15&amp;quot;

=======  03/09/10 16:20:58 MST  END Unmount Inactive System Image succeeded. (user=root)  (jobid=ivm2)

root@ivm2:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Now we are going to create the new virtual machine with &lt;code&gt;hpvmclone&lt;/code&gt;. Of course the new IVM can be created through &lt;code&gt;hpvmcreate&lt;/code&gt; and add the new disk as its boot disk.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmclone -P ivm2 -N ivm3 -B manual -d disk:scsi:0,1,0:lv:/dev/vg_vmtest/rivm2disk
[root@hpvmhost] ~ # hpvmstatus -P ivm3
[Virtual Machine Details]
Virtual Machine Name VM #  OS Type State
==================== ===== ======= ========
ivm3                     4 HPUX    Off      

[Authorized Administrators]
Oper Groups: 
Admin Groups:
Oper Users:  
Admin Users: 

[Virtual CPU Details]
#vCPUs Entitlement Maximum
====== =========== =======
     1       10.0%  100.0%

[Memory Details]
Total    Reserved
Memory   Memory 
=======  ========
   3 GB     64 MB

[Storage Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
dvd     scsi         0   1   0   1   0 disk      /dev/rdsk/c1t4d0
disk    scsi         0   1   0   2   0 lv        /dev/vg_vmtest/rivm3disk

[Network Interface Details]
Interface Adaptor    Name/Num   PortNum Bus Dev Ftn Mac Address
========= ========== ========== ======= === === === =================
vswitch   lan        vlan02     11        0   0   0 52-4f-f9-5e-02-82

[Misc Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
serial  com1                           tty       console
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Final step is to boot the newly create machine, from the EFI menu we’re going to create a new boot file.&lt;/li&gt;
  &lt;li&gt;First select the &lt;em&gt;Boot option maintenance menu&lt;/em&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Manager ver 1.10 [14.62] [Build: Mon Oct  1 09:27:26 2007]

Please select a boot option

    HP-UX Primary Boot: 0/0/1/0.0.0                                
    EFI Shell [Built-in]                                           
    Boot option maintenance menu                                   

    Use ^ and v to change option(s). Use Enter to select an option&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Now go to &lt;code&gt;Add a Boot Option&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Maintenance Manager ver 1.10 [14.62]

Main Menu. Select an Operation

        Boot from a File                                           
        Add a Boot Option                                          
        Delete Boot Option(s)                                      
        Change Boot Order                                          

        Manage BootNext setting                                    
        Set Auto Boot TimeOut                                      

        Select Active Console Output Devices                       
        Select Active Console Input Devices                        
        Select Active Standard Error Devices                       

        Cold Reset                                                 
        Exit                                                       

    Timeout--&amp;gt;[10] sec SystemGuid--&amp;gt;[5A0F8F26-2BA2-11DF-9C04-001A4B07F002]
    SerialNumber--&amp;gt;[VM01010008          ]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Select the first partition of the disk.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Maintenance Manager ver 1.10 [14.62]

Add a Boot Option.  Select a Volume

    IA64_EFI [Acpi(PNP0A03,0)/Pci(1|0)/Scsi(Pun2,Lun0)/HD(Part1,Sig7
    IA64_EFI [Acpi(PNP0A03,0)/Pci(1|0)/Scsi(Pun2,Lun0)/HD(Part3,Sig7
    Removable Media Boot [Acpi(PNP0A03,0)/Pci(1|0)/Scsi(Pun1,Lun0)]
    Load File [Acpi(PNP0A03,0)/Pci(0|0)/Mac(524FF95E0282)]         
    Load File [EFI Shell [Built-in]]                               
    Legacy Boot                                                    
    Exit&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Select the first option.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Maintenance Manager ver 1.10 [14.62]

Select file or change to new directory:

       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 EFI                      
       [Treat like Removable Media Boot]                           
    Exit&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Enter the HPUX directory.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Maintenance Manager ver 1.10 [14.62]

Select file or change to new directory:

       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 .                        
       03/09/10  03:45p &amp;lt;DIR&amp;gt;           0 ..                       
       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 HPUX                     
       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 Intel_Firmware           
       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 diag                     
       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 hp                       
       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 tools                    
    Exit&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Select the &lt;code&gt;hpux.efi&lt;/code&gt; file.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Maintenance Manager ver 1.10 [14.62]

Select file or change to new directory:

       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 .                        
       03/09/10  03:45p &amp;lt;DIR&amp;gt;       4,096 ..                       
       03/09/10  03:45p           654,025 hpux.efi                 
       03/09/10  03:45p            24,576 nbp.efi                  
    Exit&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Enter &lt;code&gt;BOOTDISK&lt;/code&gt; as description and None as BootOption Data Type. Save changes.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;Filename: \EFI\HPUX\hpux.efi
DevicePath: [Acpi(PNP0A03,0)/Pci(1|0)/Scsi(Pun2,Lun0)/HD(Part1,Sig71252358-2BCD-11DF-8000-D6217B60E588)/\EFI\HPUX\hpux.efi]

IA-64 EFI Application 03/09/10  03:45p     654,025 bytes

Enter New Description:  BOOTDISK
New BootOption Data. ASCII/Unicode strings only, with max of 240 characters

Enter BootOption Data Type [A-Ascii U-Unicode N-No BootOption] :  None

Save changes to NVRAM [Y-Yes N-No]:&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Go back to the EFI main menu and boot from the new option.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;EFI Boot Manager ver 1.10 [14.62] [Build: Mon Oct  1 09:27:26 2007]

Please select a boot option
HP-UX Primary Boot: 0/0/1/0.0.0
EFI Shell [Built-in]
BOOTDISK
Boot option maintenance menu

Use ^ and v to change option(s). Use Enter to select an option
Loading.: BOOTDISK
Starting: BOOTDISK

(C) Copyright 1999-2006 Hewlett-Packard Development Company, L.P.
All rights reserved

HP-UX Boot Loader for IPF  --  Revision 2.035

Press Any Key to interrupt Autoboot
\EFI\HPUX\AUTO ==&amp;gt; boot vmunix
Seconds left till autoboot -   0
AUTOBOOTING...&amp;gt; System Memory = 3066 MB
loading section 0
.................................................................................. (complete)
loading section 1
.............. (complete)
loading symbol table
loading System Directory (boot.sys) to MFS
.....
loading MFSFILES directory (bootfs) to MFS
................
Launching /stand/vmunix
SIZE: Text:41555K + Data:6964K + BSS:20747K = Total:69267K&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Finally the OS will ask some questions about the network configuration and other parameters, answer what suits better
your needing.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;_______________________________________________________________________________

                       Welcome to HP-UX!

Before using your system, you will need to answer a few questions.

The first question is whether you plan to use this system on a network.

Answer &amp;quot;yes&amp;quot; if you have connected the system to a network and are ready
to link with a network.

Answer &amp;quot;no&amp;quot; if you:

     * Plan to set up this system as a standalone (no networking).

     * Want to use the system now as a standalone and connect to a
       network later.
_______________________________________________________________________________

Are you ready to link this system to a network?

Press [y] for yes or [n] for no, then press [Enter] y
...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And we are done.&lt;/p&gt;

&lt;h3 id=&quot;conclusions&quot;&gt;Conclusions&lt;/h3&gt;
&lt;p&gt;I have to say that at the beginning the cloning system of HPVM disappointed me; but after a while I got used to it.&lt;/p&gt;

&lt;p&gt;In my opinion the best method of the above is the second if you have one boot disk, and I really can’t see a reason to have a &lt;code&gt;vg00&lt;/code&gt; with several PVs on a virtual machine. If you have an IVM as template and need to produce many copies as quickly as possible this method is perfect.&lt;/p&gt;

&lt;p&gt;Of course there is a fourth method: Our beloved Ignite-UX. But I will write about it in another post.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/itanium/sysadmin/virtualization/cloning-hpvm-guests/&quot;&gt;Cloning HPVM guests&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on March 09, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Moving vNICs between vSwitches]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/itanium/networking/sysadmin/virtualization/moving-vnics-between-vswitches/" />
  <id>/hp-ux/itanium/networking/sysadmin/virtualization/moving-vnics-between-vswitches</id>
  <published>2010-03-03T14:40:37+01:00</published>
  <updated>2010-03-03T14:40:37+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Following with my re-learning HPVM process today I’ve been playing around with my virtual switches and a question had arise.&lt;/p&gt;

&lt;p&gt;How can I move a virtual Nic from one vSwitch to another?&lt;/p&gt;

&lt;p&gt;I discovered is not a difficult task, just one important question to take into account, the virtual machine must be powered off. This kind of changes can’t be done if the IVM is online, at least with HPVM 3.5. I never used 4.0 or 4.1 releases of HPVM and I didn’t find anything in the documentation that suggest a different behavior.&lt;/p&gt;

&lt;p&gt;To perform the operation we’re going to use, as usual ;-), &lt;code&gt;hpvmmodify&lt;/code&gt;. It comes with the &lt;code&gt;-m&lt;/code&gt; switch to modify the I/O resources of an already existing virtual machine, but you have to specify the hardware address of the device. To identify the address of the network card  launch &lt;code&gt;hpvmstatus&lt;/code&gt; with  &lt;code&gt;-d&lt;/code&gt;, this options shows the output with the format used on the command line.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmstatus -P ivm1 -d
[Virtual Machine Devices]
...
[Network Interface Details]
network:lan:0,0,0x56E9E3096A22:vswitch:vlan02
network:lan:0,1,0xAED6F7FA4E3E:vswitch:localnet
...
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;As it can be seen in the Networking Interface Details the third field shows, separated by commas,  the lan bus, the device number and the MAC address of the &lt;code&gt;vNic&lt;/code&gt;. We only need the first two values, that is the lan bus and device number, &lt;code&gt;0,0&lt;/code&gt; in our the example.&lt;/p&gt;

&lt;p&gt;Now we can proceed.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmmodify -P ivm2 -m network:lan:0,0:vswitch:vlan03   
[root@hpvmhost] ~ #
[root@hpvmhost] ~ # hpvmstatus -P ivm1
[Virtual Machine Details]
Virtual Machine Name VM #  OS Type State
==================== ===== ======= ========
ivm1                     9 HPUX    On (OS)   
...
[Network Interface Details]
Interface Adaptor    Name/Num   PortNum Bus Dev Ftn Mac Address
========= ========== ========== ======= === === === =================
vswitch   lan        vlan03     9         0   0   0 56-e9-e3-09-6a-22
vswitch   lan        localnet   9         0   1   0 ae-d6-f7-fa-4e-3e
...
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And we are done.&lt;/p&gt;

&lt;p&gt;I will write a few additional posts covering  more HPVM tips, small ones and big ones, at the same time I’m practicing them on my lab server.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/itanium/networking/sysadmin/virtualization/moving-vnics-between-vswitches/&quot;&gt;Moving vNICs between vSwitches&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on March 03, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Coming back to the IVM world]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/itanium/virtualization/coming-back-to-the-ivm-world/" />
  <id>/hp-ux/itanium/virtualization/coming-back-to-the-ivm-world</id>
  <published>2010-03-02T15:00:24+01:00</published>
  <updated>2010-03-02T15:00:24+01:00</updated>
  <author>
    <name></name>
    <uri></uri>
    
  </author>
  <content type="html">
    &lt;p&gt;Yes I have to admit it, it’s been a while since the last time I created an Integrity Virtual Machine. In my last job didn’t have HPVM and here the VMs were already running when I arrived. So a few weeks ago I decided to cut my teeth again with HPVM, specially since I am pushing forward very hard for an OS and HPVM version upgrade of the IVM cluster which is currently running HP-UX 11.23 with HPVM 3.5.&lt;/p&gt;

&lt;p&gt;First logical step in order to get proficient again with IVM is to create a new virtual machine. I asked Javi, our storage guy, for a new LUN and after add it to my lab server I started the whole process.&lt;/p&gt;

&lt;p&gt;Some of the steps are obvious for any HP-UX Sysadmin, like VGs and LVs creation, but I decided to show the commands in order to maintain some consistency across this how-to/checklist/what-ever-you-like-to-call-it.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Create a volume group for the IVM virtual disks.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # vgcreate -s 16 -e 6000 vg_vmtest /dev/dsk/c15t7d1
Volume group &amp;quot;/dev/vg_vmtest&amp;quot; has been successfully created.
Volume Group configuration for /dev/vg_vmtest has been saved in /etc/lvmconf/vg_vmtest.conf
[root@hpvmhost] ~ #
[root@hpvmhost] ~ # vgextend vg_vmtest /dev/dsk/c5t7d1  /dev/dsk/c7t7d1 /dev/dsk/c13t7d1
Volume group &amp;quot;vg_vmtest&amp;quot; has been successfully extended.
Volume Group configuration for /dev/vg_vmtest has been saved in /etc/lvmconf/vg_vmtest.conf
[root@hpvmhost] ~ # vgdisplay -v vg_vmtest
--- Volume groups ---
VG Name                     /dev/vg_vmtest
VG Write Access             read/write     
VG Status                   available                 
Max LV                      255    
Cur LV                      0      
Open LV                     0      
Max PV                      16     
Cur PV                      1      
Act PV                      1      
Max PE per PV               6000         
VGDA                        2   
PE Size (Mbytes)            16              
Total PE                    3199    
Alloc PE                    0       
Free PE                     3199    
Total PVG                   0        
Total Spare PVs             0              
Total Spare PVs in use      0                     

--- Physical volumes ---
PV Name                     /dev/dsk/c15t7d1
PV Name                     /dev/dsk/c5t7d1  Alternate Link
PV Name                     /dev/dsk/c7t7d1  Alternate Link
PV Name                     /dev/dsk/c13t7d1 Alternate Link
PV Status                   available                
Total PE                    3199    
Free PE                     3199    
Autoswitch                  On        
Proactive Polling           On               

[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Create one &lt;code&gt;lvol&lt;/code&gt; for each disk you want to add to your virtual machine, of course these logical volumes must belong to the volume group previously created.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # lvcreate -L 12000 -n ivm1d1 vg_vmtest
Logical volume &amp;quot;/dev/vg_vmtest/ivm1d1&amp;quot; has been successfully created with
character device &amp;quot;/dev/vg_vmtest/rivm1d1&amp;quot;.
Logical volume &amp;quot;/dev/vg_vmtest/ivm1d1&amp;quot; has been successfully extended.
Volume Group configuration for /dev/vg_vmtest has been saved in /etc/lvmconf/vg_vmtest.conf
[root@hpvmhost] ~ #
[root@hpvmhost] ~ # lvcreate -L 12000 -n ivm1d2 vg_vmtest
Logical volume &amp;quot;/dev/vg_vmtest/ivm1d2&amp;quot; has been successfully created with
character device &amp;quot;/dev/vg_vmtest/rivm1d2&amp;quot;.
Logical volume &amp;quot;/dev/vg_vmtest/ivm1d2&amp;quot; has been successfully extended.
Volume Group configuration for /dev/vg_vmtest has been saved in /etc/lvmconf/vg_vmtest.conf
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Now we’re going to do some real stuff. Create the IVM with the &lt;code&gt;hpvmcreate&lt;/code&gt; command and use the &lt;code&gt;hpvmstatus&lt;/code&gt; to check that everything went well :&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmcreate -P ivm1 -O hpux  
[root@hpvmhost] ~ # hpvmstatus -P ivm1
[Virtual Machine Details]
Virtual Machine Name VM #  OS Type State
==================== ===== ======= ========
ivm1                     8 HPUX    Off       

[Authorized Administrators]
Oper Groups:  
Admin Groups:
Oper Users:   
Admin Users:  

[Virtual CPU Details]
#vCPUs Entitlement Maximum
====== =========== =======
 1       10.0%  100.0%

[Memory Details]
Total    Reserved
Memory   Memory  
=======  ========
 2 GB     64 MB

[Storage Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================

[Network Interface Details]
Interface Adaptor    Name/Num   PortNum Bus Dev Ftn Mac Address
========= ========== ========== ======= === === === =================

[Misc Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
serial  com1                           tty       console
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;We have a new virtual machine created but with no resources at all.&lt;/p&gt;

&lt;p&gt;If you have read the &lt;a href=&quot;http://docs.hp.com/en/T2767-90180/index.html&quot;&gt;HPVM documentation&lt;/a&gt;, and you should, probably know that every resource can be assigned at this step but I like to add them later one by one.&lt;/p&gt;

&lt;p&gt;Since now we’re going to use the &lt;em&gt;hpvmstatus&lt;/em&gt; to verify every change made. This command can be invoked without options to show a general summary or can query a single virtual machine, a verbose option is also available with &lt;code&gt;-V&lt;/code&gt;. Take a look of its man page to check more options.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add more CPU and RAM. The default values are 1 vCPU and 2GB of RAM, more can be assigned with &lt;code&gt;hpvmmodify&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmmodify -P ivm1 -c 2
[root@hpvmhost] ~ # hpvmmodify -P ivm1 -r 4G
[root@hpvmhost] ~ # hpvmstatus
[Virtual Machines]
Virtual Machine Name VM #  OS Type State     #VCPUs #Devs #Nets Memory  Runsysid
==================== ===== ======= ========= ====== ===== ===== ======= ========
oratest01                1 HPUX    On (OS)        4    10     3   16 GB        0
oratest02                2 HPUX    On (OS)        4     8     3   16 GB        0
sapvm01                  3 HPUX    Off            3     8     3    8 GB        0
sapvm02                  4 HPUX    Off            3     7     3    8 GB        0
sles01                   5 LINUX   On (OS)        1     4     3    4 GB        0
rhel01                   6 LINUX   Off            1     4     3    4 GB        0
hp-vxvm                  7 HPUX    On (OS)        2    17     3    6 GB        0
ivm1                     8 HPUX    Off            2     0     0    4 GB        0
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;With the CPUs and RAM finished it’s time to add the storage devices, as always we’re going to use &lt;code&gt;hpvmmodify&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmmodify -P ivm1 -a disk:scsi::lv:/dev/vg_vmtest/rivm1d1
[root@hpvmhost] ~ # hpvmmodify -P ivm1 -a disk:scsi::lv:/dev/vg_vmtest/rivm1d2
[root@hpvmhost] ~ # hpvmmodify -P ivm1 -a dvd:scsi::disk:/dev/rdsk/c1t4d0
[root@hpvmhost] ~ # hpvmstatus -P ivm1
[Virtual Machine Details]
Virtual Machine Name VM #  OS Type State
==================== ===== ======= ========
ivm1                     8 HPUX    Off       

[Authorized Administrators]
Oper Groups:  
Admin Groups:
Oper Users:   
Admin Users:  

[Virtual CPU Details]
#vCPUs Entitlement Maximum
====== =========== =======
 2       10.0%  100.0%

[Memory Details]
Total    Reserved
Memory   Memory  
=======  ========
 4 GB     64 MB

[Storage Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
disk    scsi         0   2   0   0   0 lv        /dev/vg_vmtest/rivm1d1
disk    scsi         0   2   0   1   0 lv        /dev/vg_vmtest/rivm1d2
dvd     scsi         0   2   0   2   0 disk      /dev/rdsk/c1t4d0

[Network Interface Details]
Interface Adaptor    Name/Num   PortNum Bus Dev Ftn Mac Address
========= ========== ========== ======= === === === =================

[Misc Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
serial  com1                           tty       console
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;An important tip about the storage devices, remember that you have to use the character device file of the LV. If a block device is used you will get the following error:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmmodify -P ivm1 -a disk:scsi::lv:/dev/vg_vmtest/ivm1d1
hpvmmodify: WARNING (ivm1): Expecting a character device file for disk backing file, but &amp;#39;/dev/vg_vmtest/ivm1d1&amp;#39; appears to be a block device.
hpvmmodify: ERROR (ivm1): Illegal blk device &amp;#39;/dev/vg_vmtest/ivm1d1&amp;#39; as backing device.
hpvmmodify: ERROR (ivm1): Unable to add device &amp;#39;/dev/vg_vmtest/ivm1d1&amp;#39;.
hpvmmodify: Unable to create device disk:scsi::lv:/dev/vg_vmtest/ivm1d1.
hpvmmodify: Unable to modify the guest.
[root@hpvmhost] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Virtual networking 1: First check the available virtual switches with &lt;code&gt;hpvmnet&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] / # hpvmnet
Name     Number State   Mode      NamePPA  MAC Address    IP Address
======== ====== ======= ========= ======== ============== ===============
localnet      1 Up      Shared             N/A            N/A
vlan02        2 Up      Shared    lan3     0x000000000000 192.168.1.12
vlan03        3 Up      Shared    lan4     0x001111111111 10.10.3.4
[root@hpvmhost] / #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Virtual Networking 2: Add a couple of &lt;code&gt;vnics&lt;/code&gt; to the virtual machine.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] / # hpvmmodify -P ivm1 -a network:lan:vswitch:vlan02
[root@hpvmhost] / # hpvmmodify -P ivm1 -a network:lan:vswitch:localnet
[root@hpvmhost] / #
[root@hpvmhost] / # hpvmstatus -P ivm1
[Virtual Machine Details]
Virtual Machine Name VM #  OS Type State
==================== ===== ======= ========
ivm1                     8 HPUX    Off       

[Authorized Administrators]
Oper Groups:  
Admin Groups:
Oper Users:   
Admin Users:  

[Virtual CPU Details]
#vCPUs Entitlement Maximum
====== =========== =======
 2       10.0%  100.0%

[Memory Details]
Total    Reserved
Memory   Memory  
=======  ========
 4 GB     64 MB

[Storage Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
disk    scsi         0   2   0   0   0 lv        /dev/vg_vmtest/rivm1d1
disk    scsi         0   2   0   1   0 lv        /dev/vg_vmtest/rivm1d2
dvd     scsi         0   2   0   2   0 disk      /dev/rdsk/c1t4d0

[Network Interface Details]
Interface Adaptor    Name/Num   PortNum Bus Dev Ftn Mac Address
========= ========== ========== ======= === === === =================
vswitch   lan        vlan02     8         0   0   0 56-e9-e3-09-6a-22
vswitch   lan        localnet   8         0   1   0 ae-d6-f7-fa-4e-3e

[Misc Interface Details]
Guest                                 Physical
Device  Adaptor    Bus Dev Ftn Tgt Lun Storage   Device
======= ========== === === === === === ========= =========================
serial  com1                           tty       console
[root@hpvmhost] / #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;And we have an IVM ready to be used. To start it use the  &lt;code&gt;hpvmstart&lt;/code&gt; command and access its console with &lt;code&gt;hpvmconsole&lt;/code&gt;, the interface is almost equal to GSP/MP.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@hpvmhost] ~ # hpvmstart -P ivm1
(C) Copyright 2000 - 2008 Hewlett-Packard Development Company, L.P.
Opening minor device and creating guest machine container
Creation of VM, minor device 3
Allocating guest memory: 4096MB
  allocating low RAM (0-80000000, 2048MB)
/opt/hpvm/lbin/hpvmapp (/var/opt/hpvm/uuids/2b3b1198-2062-11df-9e06-001a4b07f002/vmm_config.current): Allocated 2147483648 bytes at 0x6000000100000000
  allocating high RAM (100000000-180000000, 2048MB)
/opt/hpvm/lbin/hpvmapp (/var/opt/hpvm/uuids/2b3b1198-2062-11df-9e06-001a4b07f002/vmm_config.current): Allocated 2147483648 bytes at 0x6000000200000000
    locking memory: 100000000-180000000
    allocating datalogger memory: FF800000-FF840000 (256KB for 155KB)
/opt/hpvm/lbin/hpvmapp (/var/opt/hpvm/uuids/2b3b1198-2062-11df-9e06-001a4b07f002/vmm_config.current): Allocated 262144 bytes at 0x6000000300000000
    locking datalogger memory
  allocating firmware RAM (fff00000-fff20000, 128KB)
/opt/hpvm/lbin/hpvmapp (/var/opt/hpvm/uuids/2b3b1198-2062-11df-9e06-001a4b07f002/vmm_config.current): Allocated 131072 bytes at 0x6000000300080000
    locked SAL RAM: 00000000fff00000 (8KB)
    locked ESI RAM: 00000000fff02000 (8KB)
    locked PAL RAM: 00000000fff04000 (8KB)
    locked Min Save State: 00000000fff06000 (8KB)
    locked datalogger: 00000000ff800000 (256KB)
Loading boot image
Image initial IP=102000 GP=67E000
Initialize guest memory mapping tables
Starting event polling thread
Starting thread initialization
Daemonizing....
hpvmstart: Successful start initiation of guest &amp;#39;ivm1&amp;#39;
[root@hpvmhost] ~ #
[root@hpvmhost] ~ # hpvmconsole -P ivm1

   vMP MAIN MENU

         CO: Console
         CM: Command Menu
         CL: Console Log
         SL: Show Event Logs
         VM: Virtual Machine Menu
         HE: Main Help Menu
         X: Exit Connection

[ivm1] vMP&amp;gt; co

       (Use Ctrl-B to return to vMP main menu.)

- - - - - - - - - - Prior Console Output - - - - - - - - - -&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And we are finished. I’m not going through the installation process since it’s not the objective of this post and it is very well documented in the HP-UX documentation.&lt;/p&gt;

&lt;p&gt;I really enjoyed this post, it has been very useful exercise in order to re-learn the roots of HPVM and a very good starting point for the HP-UX/HPVM upgrade I’m going to undertake during next weeks.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/itanium/virtualization/coming-back-to-the-ivm-world/&quot;&gt;Coming back to the IVM world&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on March 02, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Double check! Always!]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/sysadmin/double-check-always/" />
  <id>/hp-ux/sysadmin/double-check-always</id>
  <published>2010-02-24T16:40:54+01:00</published>
  <updated>2010-02-24T16:40:54+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Today I learned the hard way how important is to check everything at least twice.&lt;/p&gt;

&lt;p&gt;I had to perform an OS patching on a two node NFS cluster, a couple of &lt;a href=&quot;http://h18004.www1.hp.com/products/servers/integrity-bl/c-class/860c/index.html?jumpid=reg_R1002_USEN&quot;&gt;BL860C&lt;/a&gt; running HP-UX 11.31 with three packages, one for development, one for testing and the third for the production environment.&lt;/p&gt;

&lt;p&gt;Everything was fine until I tried to run one of the packages on its failover node in order to patch its primary, the package didn’t start. The log of the package was populated with one error after another, of course I tried to identify the source of the error… nothing, I read the config files line by line… nothing. At that point I started to sweat and then just when a I was thinking to write my resignation letter I noticed it. Somehow an extra damn &lt;em&gt;equal&lt;/em&gt; slipped into the &lt;code&gt;hanfs.sh&lt;/code&gt; file and of course the cluster didn’t recognize the sharing options and refused to start the package.&lt;/p&gt;

&lt;p&gt;In fact the downtime has not been more than a few minutes and fortunately for me not in the production package but the excuses aren’t valid, at least for me. I was so confident on my expertise that I made a newbie mistake, probably during a modification of the package after the creation of a new filesystem.&lt;/p&gt;

&lt;p&gt;Have to be more careful in the future.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/sysadmin/double-check-always/&quot;&gt;Double check! Always!&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 24, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Machinfo on PA-RISC systems]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/pa-risc/machinfo-on-pa-risc-systems/" />
  <id>/hp-ux/pa-risc/machinfo-on-pa-risc-systems</id>
  <published>2010-02-17T11:39:36+01:00</published>
  <updated>2010-02-17T11:39:36+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;When the HP-UX Itanium version was released  it came with a very handy tool named &lt;a href=&quot;http://docs.hp.com/en/B2355-60130/machinfo.1.html&quot; title=&quot;Machinfo MAN page&quot;&gt;&lt;code&gt;machinfo&lt;/code&gt;&lt;/a&gt;. This command prints number and type of CPUs, amount of memory, firmware revision, serial number, machine id and many more useful information about the server. Sadly on PA-RISC we didn’t have something similar, of course there is &lt;a href=&quot;http://www.docs.hp.com/en/5992-6587/5992-6587.pdf&quot; title=&quot;Ignite-UX Reference&quot;&gt;&lt;code&gt;print_manifest&lt;/code&gt;&lt;/a&gt; and I have to say that it’s quite a tool but I always loved the simplicity of &lt;code&gt;machinfo&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Dozens of posts have been thrown throughout the years on &lt;a href=&quot;http://forums11.itrc.hp.com/service/forums/home.do&quot; title=&quot;ITRC Forums&quot;&gt;ITRC Forums&lt;/a&gt; asking for a PA-RISC &lt;code&gt;machinfo&lt;/code&gt; version and many workarounds and even some binaries have been posted.&lt;/p&gt;

&lt;p&gt;I tried a lot of them but since I discovered &lt;a href=&quot;http://forums11.itrc.hp.com/service/forums/publicProfile.do?userId=CA687674&amp;amp;forumId=1&quot;&gt;Patrick Reut&lt;/a&gt;’s version a couple of years ago I never used another one. It works on 11.11 and 11.23 systems, I tried on 10.20 but didn’t wok. The binary can found in this &lt;a href=&quot;http://forums11.itrc.hp.com/service/forums/questionanswer.do?admit=109447626+1266396818246+28353475&amp;amp;threadId=1104988&quot;&gt;post&lt;/a&gt; as an attachment.&lt;/p&gt;

&lt;p&gt;Here it an example output of the command:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@tst1:/# which machinfo
/usr/contrib/bin/machinfo
root@tst1:/# ll /usr/contrib/bin/machinfo
lrwx------   1 root       sys             34 Feb 17 10:15 /usr/contrib/bin/machinfo@ -&amp;gt; /usr/local/scripts/parisc_machinfo
root@tst1:/#
root@tst1:/# machinfo
OS info:
 sysname  = HP-UX
 nodename = sigtst1
 release  = B.11.23
 version  = U
 machine  = 9000/800
 idnumber = 11111111111

Platform info:
 model string = &amp;quot;9000/800/rp7420&amp;quot;
 machine id number = XXXXXXXXXXXXXX
 machine serial number = DEHxxxxxxxx

CPU info
 Number of CPUs = 4
 Clock speed    = 1000 MHz
 processor family: 532 pa-2.0
 processor model:  20 PA8900

Firmware info:
 Firmware revision = 22.2

Memory = 8165 MB (7 GB)
Disk info:
c0t6d0 : HP 146 GMA  (size = 146GB)
c0t5d0 : HP 146 GMA  (size = 146GB)
c45t0d1 : HP      HS  (size = 118GB)
c45t0d4 : HP      HS  (size = 118GB)
c45t0d5 : HP      HS  (size = 118GB)
c45t0d7 : HP      HS  (size = 15GB)
c45t1d0 : HP      HS  (size = 15GB)
c47t0d1 : HP      HS  (size = 118GB)
c47t0d4 : HP      HS  (size = 118GB)
c47t0d5 : HP      HS  (size = 118GB)
c47t0d7 : HP      HS  (size = 15GB)
c47t1d0 : HP      HS  (size = 15GB)

root@tst1:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/pa-risc/machinfo-on-pa-risc-systems/&quot;&gt;Machinfo on PA-RISC systems&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 17, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Linux LVM commands in HP-UX]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/linux/linux-lvm-commands-in-hp-ux/" />
  <id>/hp-ux/linux/linux-lvm-commands-in-hp-ux</id>
  <published>2010-02-16T16:07:04+01:00</published>
  <updated>2010-02-16T16:07:04+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Some of the features I always liked about the Linux LVM2 implementation are the &lt;code&gt;lvs&lt;/code&gt;, &lt;code&gt;vgs&lt;/code&gt; and &lt;code&gt;pvs&lt;/code&gt; commands. With these simple commands a short list of the LVs, VGs and PVs active on the system can be obtained.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;www04:~ # vgs
VG            #PV #LV #SN Attr   VSize  VFree
vgwww01         1   6   0 wz--n- 39.75G   6.25G
vgbbdd          3   3   0 wz--n- 94.25G      0
vgsys           1   6   0 wz--n- 34.74G   1.25G
www04:~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In HP-UX there is nothing similar available, well since HP-UX 11.31 and LVM2 &lt;code&gt;-F&lt;/code&gt; option has been added to produce a formatted, more script friendly list but is not very human readable.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;[root@nfscl02] ~ # vgdisplay -vF vg00
vg_name=/dev/vg00:vg_write_access=read,write:vg_status=available:max_lv=255:cur_lv=9:open_lv=9:max_pv=16:cur_pv=1:act_pv=1:max_pe_per_pv=4353:vgda=2:pe_size=32:total_pe=4322:alloc_pe=1539:free_pe=2783:total_pvg=0:total_spare_pvs=0:total_spare_pvs_in_use=0:vg_version=1.0:vg_max_size=2228736m:vg_max_extents=69648
lv_name=/dev/vg00/lvol1:lv_status=available,syncd:lv_size=1856:current_le=58:allocated_pe=58:used_pv=1
lv_name=/dev/vg00/lvol2:lv_status=available,syncd:lv_size=8192:current_le=256:allocated_pe=256:used_pv=1
lv_name=/dev/vg00/lvol3:lv_status=available,syncd:lv_size=1504:current_le=47:allocated_pe=47:used_pv=1
lv_name=/dev/vg00/lvol4:lv_status=available,syncd:lv_size=512:current_le=16:allocated_pe=16:used_pv=1
lv_name=/dev/vg00/lvol5:lv_status=available,syncd:lv_size=8192:current_le=256:allocated_pe=256:used_pv=1
lv_name=/dev/vg00/lvol6:lv_status=available,syncd:lv_size=5024:current_le=157:allocated_pe=157:used_pv=1
lv_name=/dev/vg00/lvol7:lv_status=available,syncd:lv_size=5024:current_le=157:allocated_pe=157:used_pv=1
lv_name=/dev/vg00/lvol8:lv_status=available,syncd:lv_size=8704:current_le=272:allocated_pe=272:used_pv=1
lv_name=/dev/vg00/lv_crash:lv_status=available,syncd:lv_size=10240:current_le=320:allocated_pe=320:used_pv=1
pv_name=/dev/disk/disk1_p2:pv_status=available:total_pe=4322:free_pe=2783:autoswitch=On:proactive_polling=On
[root@nfscl02] ~ #&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Because of this I decided to write three scripts to emulate the behavior of &lt;code&gt;vgs&lt;/code&gt;, &lt;code&gt;lvs&lt;/code&gt; and &lt;code&gt;pvs&lt;/code&gt; on my HP-UX servers. This scripts take advantage of the mentioned LVM2 &lt;code&gt;-F&lt;/code&gt; switch so they will not work on HP-UX 11.23 or any other previous versions. If anyones recognize the scripting style is because I grab some parts of the code from Olivier’s &lt;a href=&quot;http://jreypo.wordpress.com/2009/12/09/ioscan_fc2-sh/&quot;&gt;ioscan_fc2.sh&lt;/a&gt; and adapted them to my needs so credit goes to him also :-)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;VGS:&lt;/strong&gt; List the volume group on the &lt;code&gt;/etc/lvmtab&lt;/code&gt; file, if the server is part of a cluster the volume groups active on other nodes will be showed as deactivated. With the &lt;code&gt;-v&lt;/code&gt; switch single VGs can be queried.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@cldpp01:~# ./vgs.sh
VG         PVs   LVs   Status               Version  VGSize Free
vg00       1     9     available            1.0      135G   77G
vgdpp      1     1     available,exclusive  1.0      49G    0G
vgidbbck               deactivated
root@cldpp01:~# ./vgs.sh -v vgdpp
VG         PVs   LVs   Status               Version  VGSize Free
vgdpp      1     1     available,exclusive  1.0      49G    0G
root@cldpp01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The code:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/sbin/sh&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# vgs.sh - script to emulate the Linux LVM command vgs in HP-UX 11iv3&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (C) 2010 - Juan Manuel Rey (juanmanuel.reyportal@gmail.com)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This program is free software; you can redistribute it and/or&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# modify it under the terms of the GNU General Public License&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# as published by the Free Software Foundation; either version 2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# of the License, or (at your option) any later version.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# GNU General Public License for more details.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# You should have received a copy of the GNU General Public License&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# along with this program; if not, write to the Free Software&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;v0.1 2010/02/15&amp;quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; usage
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;VGS for HP-UX ${version}&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Usage: vgs [-v vg_name]&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        exit &lt;/span&gt;1
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;$(uname -r)&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;B.11.31&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;VGS for HP-UX only works on HP-UX 11iv3&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; in
        -v&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; usage &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vg_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        *&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  usage&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;vg_display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;vgdisplay -F&amp;quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vg_display&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;vgdisplay -F ${vg_name}&amp;quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;%-10s %-5s %-5s %-20s %-8s %-6s %-5s\n&amp;quot;&lt;/span&gt; VG PVs LVs Status Version VGSize Free

&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vg_display&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;vgdisplay
&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;status
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${status}&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;deactivated&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;deactivated
                &lt;span class=&quot;nv&quot;&gt;vg_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;vg_free&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;status
                &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;13&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;total_pe
                &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;12&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;pe_size
                &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;15&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;free_pe
                &lt;span class=&quot;nv&quot;&gt;vg_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;`/usr/bin/expr $total_pe \* $pe_size / 1024`G&amp;quot;&lt;/span&gt;
                &lt;span class=&quot;nv&quot;&gt;vg_free&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;`/usr/bin/expr $free_pe \* $pe_size / 1024`G&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;vg_name
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;pvs
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lvs
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;vgdisplay&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;19&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;version
        &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;%-10s %-5s %-5s %-20s %-8s %-6s %-5s\n&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${pvs}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lvs}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${status}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${version}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_size}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_free}&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;LVS:&lt;/strong&gt; Like its Linux counterpart shows a list with every active logical volume. As in &lt;code&gt;vgs.sh&lt;/code&gt; with the &lt;code&gt;-v&lt;/code&gt; switch you can ask the list of a specific volume group.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@asoka:/# ./lvs.sh -v vg00
LV                             VG           Status            LVSize Permissions Mirrors Stripes  Allocation
lvol1                          vg00         available,syncd   1G     read,write        0       0  strict,contiguous
lvol2                          vg00         available,syncd   8G     read,write        0       0  strict,contiguous
lvol3                          vg00         available,syncd   1G     read,write        0       0  strict,contiguous
lvol4                          vg00         available,syncd   0G     read,write        0       0  strict
lvol5                          vg00         available,syncd   20G    read,write        0       0  strict
lvol6                          vg00         available,syncd   1G     read,write        0       0  strict
lvol7                          vg00         available,syncd   5G     read,write        0       0  strict
lvol8                          vg00         available,syncd   20G    read,write        0       0  strict
lv_crash                       vg00         available,syncd   9G     read,write        0       0  strict
root@asoka:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The code:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/sbin/sh&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# lvs.sh - script to emulate the Linux LVM command lvs in HP-UX 11iv3&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (C) 2010 - Juan Manuel Rey (juanmanuel.reyportal@gmail.com)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This program is free software; you can redistribute it and/or&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# modify it under the terms of the GNU General Public License&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# as published by the Free Software Foundation; either version 2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# of the License, or (at your option) any later version.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# GNU General Public License for more details.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# You should have received a copy of the GNU General Public License&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# along with this program; if not, write to the Free Software&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;v0.1 2010/02/15&amp;quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; usage
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;LVS for HP-UX ${version}&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Usage: lvs [-v vg_name]&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;                exit &lt;/span&gt;1
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;$(uname -r)&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;B.11.31&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;LVS for HP-UX only works on HP-UX 11iv3&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; in
        -v&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; usage &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vg_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        *&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  usage&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;lv_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;vgdisplay -vF | grep lv_name&amp;quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lv_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;vgdisplay -vF ${vg_name} | grep lv_name&amp;quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;%-30s %-12s %-17s %-6s %-10s %-7s %-8s %-8s %-7s\n&amp;quot;&lt;/span&gt; LV VG Status LVSize Permissions Mirrors Stripes Allocation

&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_list&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lvlist
&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lvlist&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lv_name
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lvlist&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lv_long_name
        lvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_long_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;vg_name
        lvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_long_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lv_status
        lvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_long_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lv_perm
        lvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_long_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lv_mirrors
        lvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_long_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;11&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lv_stripes
        lvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_long_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;14&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;lv_allocation
        lvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;lv_long_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;size_megs
        &lt;span class=&quot;nv&quot;&gt;lv_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;`/usr/bin/expr $size_megs / 1024`G&amp;quot;&lt;/span&gt;

        &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;%-30s %-12s %-17s %-6s %-17s %-7s %-2s %-5s\n&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lv_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lv_status}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lv_size}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lv_perm}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lv_mirrors}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lv_stripes}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${lv_allocation}&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;PVS:&lt;/strong&gt; And now the last one. List the activated physical volumes, if a VGs is not active on the current node its PVs wouldn’t be shown. Like in &lt;code&gt;pvs.sh&lt;/code&gt; and &lt;code&gt;vgs.sh&lt;/code&gt; there is a &lt;code&gt;-v&lt;/code&gt; switch.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@oracle:~# ./pvs.sh
PV                   VG         Status               PVSize Free
/dev/disk/disk1_p2   vg00       available            135G   48G  
/dev/disk/disk28     vgora      available            1G     0G   
/dev/disk/disk29     vgora      available            5G     0G   
/dev/disk/disk30     vgora      available            3G     0G   
/dev/disk/disk31     vgora      available            51G    1G   
/dev/disk/disk32     vgora      available            1G     0G   
/dev/disk/disk37     vgora      available            3G     0G   
/dev/disk/disk38     vgora      available            6G     0G   /dev/disk/disk43     vgoracli   available            3G     0G   
/dev/disk/disk119    vgoracli   available            2G     0G  
root@oracle:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And the code:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/sbin/sh&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# pvs.sh - script to emulate the Linux LVM command pvs in HP-UX 11iv3&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (C) 2010 - Juan Manuel Rey (juanmanuel.reyportal@gmail.com)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This program is free software; you can redistribute it and/or&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# modify it under the terms of the GNU General Public License&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# as published by the Free Software Foundation; either version 2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# of the License, or (at your option) any later version.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# GNU General Public License for more details.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# You should have received a copy of the GNU General Public License&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# along with this program; if not, write to the Free Software&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;v0.1 2010/02/15&amp;quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; usage
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;PVS for HP-UX ${version}&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Usage: pvs [-v vg_name]&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;        exit &lt;/span&gt;1
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;$(uname -r)&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;B.11.31&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;PVS for HP-UX only works on HP-UX 11iv3&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;then&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; in
        -v&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;shift&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&amp;quot;$1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; usage &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vg_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        *&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  usage&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;esac&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;pv_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;vgdisplay -vF | grep disk&amp;quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; ! &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pv_list&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;vgdisplay -vF ${vg_name} | grep disk&amp;quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;%-20s %-10s %-20s %-6s %-5s\n&amp;quot;&lt;/span&gt; PV VG Status PVSize Free

&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pv_list&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;pvlist
&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pvlist&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;pv_name
        pvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pv_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;/&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;vg_name
        pvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pv_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;status
        pvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pv_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;total_pe
        pvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pv_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;pe_size
        pvdisplay -F &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;pv_name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;:&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; cut -d &lt;span class=&quot;s2&quot;&gt;&amp;quot;=&amp;quot;&lt;/span&gt; -f &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;free_pe
        &lt;span class=&quot;nv&quot;&gt;pv_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;`/usr/bin/expr $total_pe \* $pe_size / 1024`G&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;pv_free&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;`/usr/bin/expr $free_pe \* $pe_size / 1024`G&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;%-20s %-10s %-20s %-6s %-5s\n&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${pv_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${vg_name}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${status}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${pv_size}&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;${pv_free}&amp;quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;These scripts are available also on my &lt;a href=&quot;https://github.com/jreypo/hpux-scripts&quot;&gt;HP-UX Scripts&lt;/a&gt; Github repository. As always any comments, corrections and/or suggestions are welcome.&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/linux/linux-lvm-commands-in-hp-ux/&quot;&gt;Linux LVM commands in HP-UX&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 16, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Happy Birthday to me!]]></title>
  <link rel="alternate" type="text/html" href="/personal/happy-birthday-to-me/" />
  <id>/personal/happy-birthday-to-me</id>
  <published>2010-02-11T16:15:47+01:00</published>
  <updated>2010-02-11T16:15:47+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Today is my birthday, 34 years. All kind of gifts would be welcome, specially PA-RISC or Itanium servers, EVAs, ProLiant servers, &lt;put_here_your_cool_piece_of_technology&gt;.&lt;/put_here_your_cool_piece_of_technology&gt;&lt;/p&gt;

&lt;p&gt;I couldn’t resist x-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/personal/happy-birthday-to-me/&quot;&gt;Happy Birthday to me!&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 11, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Playing with lanadmin & lanscan]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/networking/sysadmin/playing-with-lanadmin-lanscan/" />
  <id>/hp-ux/networking/sysadmin/playing-with-lanadmin-lanscan</id>
  <published>2010-02-09T16:19:03+01:00</published>
  <updated>2010-02-09T16:19:03+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Current release of HP-UX, 11.31, has the handy &lt;code&gt;nwmgr&lt;/code&gt; to handle networking tasks, but for years instead of &lt;code&gt;nwmgr&lt;/code&gt; we’ve been playing with &lt;code&gt;lanscan&lt;/code&gt; and &lt;code&gt;lanadmin&lt;/code&gt;, &lt;code&gt;linkloop&lt;/code&gt; as well, to perform many networking tasks on the 11.23 release and previous ones. And surely some of you, just like myself, still have 11iv2 systems up and running. Following is a small list of tips and tasks for &lt;code&gt;lanadmin&lt;/code&gt; from one of my &lt;em&gt;how-to&lt;/em&gt; files.&lt;/p&gt;

&lt;h3 id=&quot;lanscan&quot;&gt;Lanscan &lt;/h3&gt;
&lt;p&gt;&lt;code&gt;lanscan&lt;/code&gt; is used to get information about the LAN interfaces.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:~# lanscan
Hardware Station        Crd Hdw   Net-Interface  NM  MAC       HP-DLPI DLPI
Path     Address        In# State NamePPA        ID  Type      Support Mjr#
0/0/0/1/0 0x001A4B07F002 0   UP    lan0 snap0     1   ETHER     Yes     119
0/0/0/1/1 0x001A4B07F003 1   UP    lan1 snap1     2   ETHER     Yes     119
0/0/1/1/0 0x0018FE2D7EE7 2   UP    lan2 snap2     3   ETHER     Yes     119
0/0/9/1/0 0x0018FE2D7EF4 3   UP    lan3 snap3     4   ETHER     Yes     119
0/0/10/1/0 0x000CFC0046B9 4   UP    lan4 snap4     5   ETHER     Yes     119
0/0/12/1/0 0x000CFC004672 5   UP    lan5 snap5     6   ETHER     Yes     119
LinkAgg0 0x000000000000 900 DOWN  lan900 snap900 9   ETHER     Yes     119
LinkAgg1 0x000000000000 901 DOWN  lan901 snap901 10  ETHER     Yes     119
LinkAgg2 0x000000000000 902 DOWN  lan902 snap902 11  ETHER     Yes     119
LinkAgg3 0x000000000000 903 DOWN  lan903 snap903 12  ETHER     Yes     119
LinkAgg4 0x000000000000 904 DOWN  lan904 snap904 13  ETHER     Yes     119
root@sap01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;A verbose version can be obtained with the &lt;code&gt;-v&lt;/code&gt; switch, but for me this switch has a glitch since you can’t query for a single LAN card:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:~# lanscan -v
-------------------------------------------------------------------------------
Hardware Station        Crd Hdw   Net-Interface  NM  MAC       HP-DLPI DLPI
Path     Address        In# State NamePPA        ID  Type      Support Mjr#
0/0/0/1/0 0x001A4B07F002 0   UP    lan0 snap0     1   ETHER     Yes     119

Extended Station                           LLC Encapsulation
Address                                    Methods
0x001A4B07F002                             IEEE HPEXTIEEE SNAP ETHER NOVELL 

Driver Specific Information
iether
-------------------------------------------------------------------------------
...
root@sap01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;There are other options for &lt;code&gt;lanscan&lt;/code&gt; that can be used to obtain more simple info in a script friendly list format:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:~# lanscan -a
0x001A4B07F002
0x001A4B07F003
0x0018FE2D7EE7
0x0018FE2D7EF4
0x000CFC0046B9
0x000CFC004672
0x000000000000
0x000000000000
0x000000000000
0x000000000000
0x000000000000
root@sap01:~# lanscan -i
lan0 snap0
lan1 snap1
lan2 snap2
lan3 snap3
lan4 snap4
lan5 snap5
lan900 snap900
lan901 snap901
lan902 snap902
lan903 snap903
lan904 snap904
root@sap01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;lanadmin&quot;&gt;Lanadmin&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;lanadmin&lt;/code&gt; command, according to its man page, allows you to:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Display and change the station address.&lt;/li&gt;
  &lt;li&gt;Display and change the 802.5 Source Routing options (RIF).&lt;/li&gt;
  &lt;li&gt;Display and change the maximum transmission unit (MTU).&lt;/li&gt;
  &lt;li&gt;Display and change the speed setting.&lt;/li&gt;
  &lt;li&gt;Clear the network statistics registers to zero.&lt;/li&gt;
  &lt;li&gt;Display the interface statistics.&lt;/li&gt;
  &lt;li&gt;Display the interface usage information.&lt;/li&gt;
  &lt;li&gt;Reset the interface card, thus executing its self-test.&lt;/li&gt;
  &lt;li&gt;Configure VLANs on the cards that support VLAN.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It can be used in two ways, if invoked with no options from the shell it will present a menu style interface where different tasks can be performed. Following is am example to illustrate.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;LOCAL AREA NETWORK ONLINE ADMINISTRATION, Version 1.0
                       Tue , Feb 9,2010  14:22:27

               Copyright 1994 Hewlett Packard Company.
                       All rights are reserved.

Test Selection mode.

        lan      = LAN Interface Administration
        menu     = Display this menu
        quit     = Terminate the Administration
        terse    = Do not display command menu
        verbose  = Display command menu

Enter command: lan

LAN Interface test mode. LAN Interface PPA Number = 0

        clear    = Clear statistics registers
        display  = Display LAN Interface status and statistics registers
        end      = End LAN Interface Administration, return to Test Selection
        menu     = Display this menu
        ppa      = PPA Number of the LAN Interface
        quit     = Terminate the Administration, return to shell
        reset    = Reset LAN Interface to execute its selftest
        specific = Go to Driver specific menu

Enter command: display

                      LAN INTERFACE STATUS DISPLAY
                       Tue , Feb 9,2010  14:22:31

PPA Number                      = 0
Description                     = lan0 HP PCI Core I/O 1000Base-T Release B.11.23.0712.01
Type (value)                    = ethernet-csmacd(6)
MTU Size                        = 1500
Speed                           = 1000000000
Station Address                 = 0x14c2650091
Administration Status (value)   = up(1)
Operation Status (value)        = up(1)
Last Change                     = 419
Inbound Octets                  = 120454615
Inbound Unicast Packets         = 863761
Inbound Non-Unicast Packets     = 4327
Inbound Discards                = 0
Inbound Errors                  = 0
Inbound Unknown Protocols       = 12
Outbound Octets                 = 145033817
Outbound Unicast Packets        = 1285500
Outbound Non-Unicast Packets    = 221
Outbound Discards               = 0
Outbound Errors                 = 0
Outbound Queue Length           = 0
Specific                        = 655367

Press  to continue

Ethernet-like Statistics Group

Index                           = 1
Alignment Errors                = 0
FCS Errors                      = 0
Single Collision Frames         = 0
Multiple Collision Frames       = 0
Deferred Transmissions          = 0
Late Collisions                 = 0
Excessive Collisions            = 0
Internal MAC Transmit Errors    = 0
Carrier Sense Errors            = 0
Frames Too Long                 = 0
Internal MAC Receive Errors     = 0

LAN Interface test mode. LAN Interface PPA Number = 0

        clear    = Clear statistics registers
        display  = Display LAN Interface status and statistics registers
        end      = End LAN Interface Administration, return to Test Selection
        menu     = Display this menu
        ppa      = PPA Number of the LAN Interface
        quit     = Terminate the Administration, return to shell
        reset    = Reset LAN Interface to execute its selftest
        specific = Go to Driver specific menu

Enter command:&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;When used with options from the command line &lt;code&gt;lanadmin&lt;/code&gt; can perform the same tasks as as in the menu interface on each LAN card. Here are some of the most common features I’ve been using for years.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Display interface info:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:~# lanadmin -x card_info  1
*********** Version Information **********
Driver version: B.11.23.0712
Firmware version: N/A
Chip version: 0x3
PCI Sub-System ID: 0x12a6
PCI Sub-Vendor ID: 0x103c
Board Revision: D4503807
Software Key: 0
Engineering Date Code: A-4731

********** Card Setting ***********
Driver State: IETHER_ONLINE
Auto Negotiation: On
Flow Control: On
Send Max Buf Descriptors: 1
Recv Max Buf Descriptors: 1
Send Coalesced Ticks: 150
Recv Coalesced Ticks: 0
root@sap01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Display Auto-Port Aggregation status:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:~# lanadmin -x -v 900
Link Aggregate PPA #      : 900
Number of Ports           : 2
Ports PPA                 : 0 1
Link Aggregation State    : LINKAGG MANUAL
Load Balance Mode         : Hot Standby (LB_HOT_STANDBY)

root@sap01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Show speed settings:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:/# lanadmin -x 1
Speed = 1000 Full-Duplex.
Autonegotiation = On.

root@sap01:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Creating an Aggregation link:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;roo@sap01:/# lanadmin -X -a 1 2 900&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Show load balancing algorithm in APA:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap02:/etc# lanadmin -x -l 900
Load Balancing = Hot Standby (LB_HOT_STANDBY)
root@sap02:/etc#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Display MAC address:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:~# lanadmin -a 1  
Station Address                 = 0x001a4b07f003
root@sap01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Display driver and adapter statistics:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:/# lanadmin -x stats drv 1
****** Driver Statistics ******        
In Packet Error                                        0
Out Packet Error                                       0
Loopback packets                                      44
Link Down events                                       0

****** Host Command Statistics ******  
nicCmdsDelMCastAddr                                    0
nicCmdsSetMACAddr                                      0
nicCmdsSetPromiscMode                                  0
nicCmdsSetMulticastMode                                0
nicCmdsClearStats                                      1

****** NIC Events Statistics ******    
nicEventsFirmwareOperational                           0
nicEventsStatsUpdated                                  0
nicEventsLinkStateChanged                              1
nicEventsMCastListUpdated                              0

****** Interface Statistics ******     
ifIndex                                                2
ifType                                                 6
ifMtu                                               1500
ifSpeed                                       1000000000
ifAdminStatus                                          1
ifOperStatus                                           1
ifLastChange                                          36
ifInDiscards                                           0
ifInErrors                                             0
ifInUnknownProtos                                  87777
ifOutDiscards                                          0
ifOutErrors                                            0
ifOutQLen                                              0
ifInOctets_low                                1205643914
ifInOctets_high                                        0
ifInUcastPkts_low                                8695826
ifInUcastPkts_high                                     0
ifInMulticastPkts_low                                  0
ifInMulticastPkts_high                                 0
ifInBroadcastPkts_low                              87777
ifInBroadcastPkts_high                                 0
ifOutOctets_low                               1200310422
ifOutOctets_high                                       0
ifOutUcastPkts_low                               8696015
ifOutUcastPkts_high                                    0
ifOutMulticastPkts_low                                 0
ifOutMulticastPkts_high                                0
ifOutBroadcastPkts_low                                 0
ifOutBroadcastPkts_high                                0
root@sap01:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Show Vital Product Data, a really funny name ;-) don’t you think?&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:/# lanadmin -x vpd 0
*********** Vital Product Data **********
Product Description: PCI/PCI-X 10/100/1000BT Dual Ethernet Adapter
Part Number: A7012-60601
Engineering Date Code: A-4731
Part Serial Number: 001A4B07F002
Misc. Information: 7.5W
Mfd. Date: 4749
Checksum: 0xb
EFI Version: 03048
ROM Firmware Version: N/A
Asset Tag: N/A
root@sap01:/#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Show card type:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;root@sap01:~# lanadmin -x type 1     
1000Base-T

root@sap01:~#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And we are finished. Probably I’m forgetting a more interesting uses of &lt;code&gt;lanadmin&lt;/code&gt; if you have other everyday use please comment :-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/networking/sysadmin/playing-with-lanadmin-lanscan/&quot;&gt;Playing with lanadmin &amp; lanscan&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 09, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[SSH foolishness]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/sysadmin/ssh-foolishness/" />
  <id>/hp-ux/sysadmin/ssh-foolishness</id>
  <published>2010-02-08T16:25:30+01:00</published>
  <updated>2010-02-08T16:25:30+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Today it’s been one of those days that you wish to hide very deep under your desk.&lt;/p&gt;

&lt;p&gt;For a couple of days I’ve been battling with a 11.31 server over its &lt;a href=&quot;http://www.docs.hp.com/en/5992-4213/index.html&quot;&gt;&lt;code&gt;sshd&lt;/code&gt;&lt;/a&gt; configuration, somehow this was the only node which refused the + &lt;code&gt;public-key&lt;/code&gt; SSH authentication method from my management server and always asked for root password, that means I could’t run scripts remotely with a convenient for loop over the sever list, no remote tests, no cron tasks from the management node against it, etc; and that’s unacceptable for me.&lt;/p&gt;

&lt;p&gt;I almost wiped out the config of the target server and recreated it from scratch using the &lt;code&gt;sshd_config&lt;/code&gt; file of a working 11.31 node as my starting point and still the damn server asked for a password. I was desperate, looking through the config file one time after another, checked file permissions, running the same test from other servers with same result.&lt;/p&gt;

&lt;p&gt;Finally I ask a colleague if he could review my &lt;code&gt;sshd_config&lt;/code&gt; file, at first look he found nothing wrong and then he performed some test and MAGIC!! it worked. I asked him about his “guru trick” and he said ‘Dude, your root home had 777 permissions’ ‘WHAT?!?!?!?’&lt;/p&gt;

&lt;p&gt;I was terribly embarrassed, one of the first tasks I do after install any HP-UX box is to move the root home from &lt;code&gt;*/*&lt;/code&gt; to &lt;code&gt;*/root*&lt;/code&gt; and in this almost newly deployed 11.31 I didn’t change the permissions. Of course I quickly checked all my servers just in case and fortunately for me none of them had a misconfigured &lt;code&gt;sshd&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Two days completely lost fighting against my foolishness, got out of bed on the wrong side this morning.&lt;/p&gt;

&lt;p&gt;Oh I almost forgot… thanks &lt;a href=&quot;http://es.linkedin.com/pub/francisco-javier-bravo-d%C3%ADaz/12/2b3/324&quot;&gt;Javi&lt;/a&gt;, you’re the best :-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/sysadmin/ssh-foolishness/&quot;&gt;SSH foolishness&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 08, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[HP-UX 10.20, still around :-)]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/pa-risc/hp-ux-10-20-still-around/" />
  <id>/hp-ux/pa-risc/hp-ux-10-20-still-around</id>
  <published>2010-02-05T14:02:26+01:00</published>
  <updated>2010-02-05T14:02:26+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;Ten years or so ago the first HP-UX I worked with was a 10.20, it was an old D230 HP9000 server.&lt;/p&gt;

&lt;p&gt;I never thought I would find a still running 10.20 server but when I came to the customer I am currently assigned I had a nice surprise. Hidden in the lab room next to the data-center was an old HP9000 D330 server with HP-UX 10.20 installed on it. And you know what? It’s still in production running an ancient version of Informix for a legacy service.&lt;/p&gt;

&lt;p&gt;The server has one PA-7200LC 160MHz CPU, 192MB of RAM and four Seagate ST34572WC Ultra SCSI 4GB disks. Since I discovered it the Informix has become my favorite server above the Superdomes or the Integrity Blades and I even found &lt;code&gt;bash&lt;/code&gt; and &lt;code&gt;lsof&lt;/code&gt; depots for 10.20 :-D&lt;/p&gt;

&lt;p&gt;Bash can be found on this &lt;a href=&quot;http://ftp.hi.is/pub/unix/hpux/&quot;&gt;FTP site&lt;/a&gt; and &lt;code&gt;lsof&lt;/code&gt; and a lot more OpenSource software for 10.20 and 11.00 can be found at &lt;a href=&quot;http://mirrors.develooper.com/hpux/downloads.html&quot;&gt;Merjin’s HP-UX&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Here it is screenshot of a PuTTY session and a couple of pictures of the beast taken with my E71:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/10_20.jpg&quot;&gt;&lt;img src=&quot;/images/10_20.jpg&quot; alt=&quot;HP-UX 10.20&quot; title=&quot;HP-UX 10.20&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/d330_view.jpg&quot;&gt;&lt;img src=&quot;/images/d330_view.jpg&quot; alt=&quot;D330&quot; title=&quot;D330&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;/images/d330_disks.jpg&quot;&gt;&lt;img src=&quot;/images/d330_disks.jpg&quot; alt=&quot;D330 Disks&quot; title=&quot;D330_disks&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Does anyone of you have an old HP-UX 10.20 still around?&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/pa-risc/hp-ux-10-20-still-around/&quot;&gt;HP-UX 10.20, still around :-)&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 05, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Open Source software and HP-UX]]></title>
  <link rel="alternate" type="text/html" href="/hp-ux/open-source-software-and-hp-ux/" />
  <id>/hp-ux/open-source-software-and-hp-ux</id>
  <published>2010-02-05T11:14:55+01:00</published>
  <updated>2010-02-05T11:14:55+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;HP-UX is a great OS and the default installation provides a plethora of tools for any Unix sysadmin but of course, like almost every operative system, it can improved with third-party OpenSource software&lt;/p&gt;

&lt;p&gt;This is a short list of the packages I can’t live without, all of them can be obtained at the &lt;a href=&quot;http://hpux.connect.org.uk/&quot;&gt;Porting And Archive Centre for HP-UX&lt;/a&gt; or the &lt;a href=&quot;http://h20338.www2.hp.com/enterprise/w1/en/os/hpux11i-internet-express.html&quot;&gt;HP-UX 11i Internet Express&lt;/a&gt; collection. The packages included in the Internet Express collection are fully supported and tested by HP.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Bash shell&lt;/strong&gt;. The best Unix shell, at least for
me, powerful and highly customizable.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;GNU coreutils&lt;/strong&gt;. Provides with GNU version of many Unix commands,
what can I say? I like the GNU &lt;em&gt;ls&lt;/em&gt; colored output x-)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;/images/coreutils1.jpg&quot;&gt;&lt;img src=&quot;/images/coreutils1.jpg&quot; alt=&quot;GNU coreutils at work&quot; title=&quot;GNU coreutils at work&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;lsof&lt;/code&gt; How can any sysadmin live without &lt;code&gt;lsof&lt;/code&gt;?&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;sudo&lt;/code&gt; Indispensable to allow scripts or users run certain commands as root or any other user.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;unzip&lt;/code&gt; It’s not that I use it but every time I set up a new server to run Oracle the database people ask for it so I got used to install it.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;tcpdump&lt;/code&gt; Don’t install it by default on my servers but I like to have the depot around, just in case.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;tusc&lt;/code&gt; God bless Chris Bertin!&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;vim&lt;/code&gt; Not on my production servers but I like to have VI Improved installed on my management node, usually the Ignite-UX server, where I store all my scripts and with ssh (public key authentication) access to all the nodes.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Of course all of them have dependencies that have to be met, however with the exception of vim, which have tons of them, there aren’t too much.&lt;/p&gt;

&lt;p&gt;And that’s all folks, which OpenSource package do you use in your HP-UX boxes? Please comment :-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp-ux/open-source-software-and-hp-ux/&quot;&gt;Open Source software and HP-UX&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 05, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[Tukwila, we are almost there]]></title>
  <link rel="alternate" type="text/html" href="/hp/itanium/opinion/tukwila-we-are-almost-there/" />
  <id>/hp/itanium/opinion/tukwila-we-are-almost-there</id>
  <published>2010-02-03T14:58:45+01:00</published>
  <updated>2010-02-03T14:58:45+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;It seems that finally and after a myriad of delays &lt;strong&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Tukwila_%28processor%29&quot; title=&quot;Tukwila&quot;&gt;Tukwila&lt;/a&gt;&lt;/strong&gt;, the brand new quad-core &lt;a href=&quot;http://www.intel.com/products/processor/itanium/index.htm&quot;&gt;Itanium&lt;/a&gt; processor from Intel, is going to be released. Yesterday through its
&lt;a href=&quot;http://www.intel.com/pressroom/chipshots/chipshots.htm&quot; title=&quot;Intel PR Chip Shots&quot;&gt;Chip Shots&lt;/a&gt; bulletin board, Intel announced that &lt;em&gt;“Tukwila (…) has begun revenue shipments”&lt;/em&gt; and a Q1 launch has to be expected.&lt;/p&gt;

&lt;p&gt;There have been &lt;a href=&quot;http://www.theregister.co.uk/2010/02/02/intel_server_chip_launches/&quot;&gt;reports&lt;/a&gt; about an announcement by Intel next Monday, February 8th, during the &lt;a href=&quot;http://www.isscc.org/isscc/index.htm&quot; title=&quot;ISSC&quot;&gt;ISSCC&lt;/a&gt;. The same place and date chosen by IBM to presents its new &lt;a href=&quot;http://en.wikipedia.org/wiki/POWER7&quot; title=&quot;POWER7&quot;&gt;POWER7&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I really hope that Intel finally release Tukwila during ISSCC. This processor will be the core of a brand &lt;a href=&quot;http://www.pcworld.com/article/172909/hp_prepares_new_integrity_servers_for_tukwila_launch.html?tk=rss_news&quot;&gt;new line of HP Integrity&lt;/a&gt; servers and that means more work for me ;-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp/itanium/opinion/tukwila-we-are-almost-there/&quot;&gt;Tukwila, we are almost there&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 03, 2010.&lt;/p&gt;
  </content>
</entry>


  

<entry>
  <title type="html"><![CDATA[OpenVMS Month!]]></title>
  <link rel="alternate" type="text/html" href="/hp/openvms/openvms-month/" />
  <id>/hp/openvms/openvms-month</id>
  <published>2010-02-02T15:36:34+01:00</published>
  <updated>2010-02-02T15:36:34+01:00</updated>
  <author>
    <name>Juan Manuel Rey</name>
    <uri></uri>
    <email>Juan Manuel Rey</email>
  </author>
  <content type="html">
    &lt;p&gt;February is the &lt;strong&gt;OpenVMS Month&lt;/strong&gt;. The people of &lt;a href=&quot;http://ccsscorp.com/VMSblog/index.php&quot;&gt;&lt;strong&gt;VMSblog&lt;/strong&gt;&lt;/a&gt; have launched a “&lt;a href=&quot;http://ccsscorp.com/VMSblog/index.php?entry=entry100131-204918.&quot;&gt;Call for Participation in the OpenVMS Month&lt;/a&gt;”, the event is sponsored by &lt;a href=&quot;http://www.connect-community.org/&quot;&gt;Connect&lt;/a&gt; and there will be presentations, webinars.  These are great news for me, I like OpenVMS since the very first time I worked with it more than a decade ago. It is robust, reliable and secure.&lt;/p&gt;

&lt;p&gt;For those of you who are asking if OpenVMS is still alive, the answer is Yes! OpenVMS is alive and much more, it has been ported to the Itanium platform and currently support the latest Itanium processor revisions, it runs on a wide variety of Integrity servers ranging from rx2660 to Superdome SD64B and even Integrity Blades, it’s actively marketed and fully supported by HP on Itanium and Alpha platforms and the support for VAX platforms will last until 2012, it’s going to be supported as guest OS on IVM in the near future and many HP technologies are already ported or will be in the next years.&lt;/p&gt;

&lt;p&gt;The official roadmap can be reviewed &lt;a href=&quot;http://h71000.www7.hp.com/openvms/roadmap/openvms_roadmaps.htm&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you want to give OpenVMS a try here are a some resources to start.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://h71000.www7.hp.com/index.html?jumpid=/go/openvms&quot;&gt;HP OpenVM site&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://h71000.www7.hp.com/doc/index.html?jumpid=/go/openvms/doc&quot;&gt;OpenVMS documentation&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.openvms.org/&quot;&gt;OpenVMS Community Portal&lt;/a&gt;, along with the OpenVMS Hobbyist Portal they are the best non-HP resources for OpenVMS.&lt;/li&gt;
  &lt;li&gt;The &lt;a href=&quot;http://www.openvmshobbyist.org/news.php&quot;&gt;OpenVMS Hobbyist Portal&lt;/a&gt; it has a small but great list of links regarding OpenVMS, information about emulators, white papers, software downloads and the famous &lt;a href=&quot;http://www.montagar.com/hobbyist/mount.html&quot;&gt;OpenVMS Hobbyist Kits&lt;/a&gt; for sale, ther are Alpha and a VAX versions for $30 each shipping included.&lt;/li&gt;
  &lt;li&gt;There is also an OpenVMS forum at &lt;a href=&quot;http://forums11.itrc.hp.com/service/forums/familyhome.do?familyId=288&quot; title=&quot;OpeVMS ITRC forum&quot;&gt;ITRC&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Apart from those links David Douthitt has written today an entry in his blog &lt;a href=&quot;http://administratosphere.wordpress.com/&quot;&gt;Unix Administratosphere&lt;/a&gt; about Alpha emulators, all of them capable of running OpenVMS, a great starting point to any newcomer.&lt;/p&gt;

&lt;p&gt;So what are you waiting for? Grab your copy of OpenVMS and spread the word :-)&lt;/p&gt;

&lt;p&gt;Juanma.&lt;/p&gt;

    &lt;p&gt;&lt;a href=&quot;/hp/openvms/openvms-month/&quot;&gt;OpenVMS Month!&lt;/a&gt; was originally published by Juan Manuel Rey at &lt;a href=&quot;&quot;&gt;Juanma's Blog&lt;/a&gt; on February 02, 2010.&lt;/p&gt;
  </content>
</entry>

</feed>
