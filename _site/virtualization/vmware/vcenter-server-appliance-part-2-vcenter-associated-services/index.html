<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>vCenter Server Appliance. Part 2 - vCenter associated services &#8211; Juanma's Blog</title>
<meta name="description" content="Welcome back to this three-part series of articles about the new vCenter Server Appliance. In this second post we will see how the additional vCenter services work in the VCSA and how to configure them.

">
<meta name="keywords" content="ESXi Netdumper, ESXi Syslog Collector, SLES 11, SuSE Linux, vCenter Server, vCenter Server Appliance, VCSA, VMware, vSphere 5, vSphere Auto Deploy">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="vCenter Server Appliance. Part 2 - vCenter associated services">
<meta name="twitter:description" content="Welcome back to this three-part series of articles about the new vCenter Server Appliance. In this second post we will see how the additional vCenter services work in the VCSA and how to configure them.

">
<meta name="twitter:site" content="@jreypo">
<meta name="twitter:creator" content="@jreypo">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="vCenter Server Appliance. Part 2 - vCenter associated services">
<meta property="og:description" content="Welcome back to this three-part series of articles about the new vCenter Server Appliance. In this second post we will see how the additional vCenter services work in the VCSA and how to configure them.

">
<meta property="og:url" content="/virtualization/vmware/vcenter-server-appliance-part-2-vcenter-associated-services/">
<meta property="og:site_name" content="Juanma's Blog">

<meta property="og:image" content="/images/default-thumb.png">






<link rel="canonical" href="/virtualization/vmware/vcenter-server-appliance-part-2-vcenter-associated-services/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Juanma's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Juanma's Blog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				        
				    
				    <li><a href="/vmware-hp-links/" >HP Resources for VMware</a></li>
				
				    
				        
				    
				    <li><a href="/tags/" >Tags</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    
  

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/bio-photo-2.jpg" class="bio-photo" alt="Juan Manuel Rey bio photo">


  <h3 itemprop="name">Juan Manuel Rey</h3>
  <p>Unix Geek. Sysadmin by heart turned cloud architect for VMware.</p>
  <a href="mailto:Juan Manuel Rey" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  <a href="http://plus.google.com/+JuanManuelReyPortal" class="author-social" target="_blank"><i class="fa fa-fw fa-google-plus-square"></i> Google+</a>
  <a href="http://linkedin.com/in/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  <a href="http://stackoverflow.com/users/2454288/jreypo" class="author-social" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i> Stackoverflow</a>
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/virtualization/vmware/vcenter-server-appliance-part-2-vcenter-associated-services/" rel="bookmark" title="vCenter Server Appliance. Part 2 - vCenter associated services">vCenter Server Appliance. Part 2 - vCenter associated services</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>Welcome back to this three-part series of articles about the new vCenter Server Appliance. In this second post we will see how the additional vCenter services work in the VCSA and how to configure them.</p>

<ul>
  <li>Syslog Collector</li>
  <li>ESXi Dump Collector (AKA Netdumper)</li>
  <li>Auto Deploy</li>
</ul>

<p>Additionally and although is not a service I decided to include a section about how to collect the vm-support scripts in the VCSA.</p>

<h3 id="syslog-collector">Syslog Collector</h3>

<p>Unlike the vCenter Windows version Syslog Collector comes bundled with the VCSA. As we saw in the previous post it can be configured from the VCSA web interface.</p>

<p><a href="/images/image_thumb151_thumb.png" title="Syslog collector settings">![]</a>](/images/image_thumb151.png)</p>

<p>But there are also a limited range of operations that can be done from the command line. Access the VCSA via SSH and make yourself root.</p>

<p>Look if the Syslog Collector is enabled.</p>

<p><a href="/images/image26.png"><img src="/images/image26.png" alt="" /></a></p>

<p>Check its status.</p>

<p><a href="/images/image27.png"><img src="/images/image27.png" alt="" title="image" /></a></p>

<p>Start and stop the Syslog Collector service.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image28.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb28.png" alt="" title="image" /></a></p>

<p>This last option is quite useful since the web interface only allows to stop/start ALL the ESXi Services at once and not individually.</p>

<p>If you want to take a look at the Syslog Collector configuration, the configuration file is located at <code>/etc/syslog-ng/syslog-collector.conf</code>.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image29.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb29.png" alt="" title="image" /></a></p>

<h3 id="esxi-dump-collector">ESXi Dump Collector</h3>

<p>Like the other services ESXi Dump Collector, also known as <code>netdumper</code>,
comes installed with the VCSA and like the Syslog Collector is enabled
by default.</p>

<p>It can be configured from the appliance Web UI in the <strong>Services</strong> tab.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image30.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb30.png" alt="image" title="image" /></a></p>

<p>From a root shell you can check the status of the service.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image31.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb31.png" alt="image" title="image" /></a></p>

<p>And start/stop the service.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image32.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb32.png" alt="image" title="image" /></a></p>

<p>The configuration of the Dump Collector is located at
<code>/etc/sysconfig/netdumper</code>.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image33.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb33.png" alt="image" title="image" /></a></p>

<p>Take a look at the following variables:</p>

<ul>
  <li><strong>NETDUMPER_DIR</strong> - Storage point for the cores.</li>
  <li><strong>NETDUMPER_DIR_MAX</strong> - Amount of space configured for the cores.</li>
  <li><strong>NETDUMPER_PORT</strong> - TCP port of the service, set from the web UI.</li>
  <li><strong>NETDUMPER_LOG_FILE</strong> - Netdumper log file location</li>
  <li><strong>NETDUMPER_OPTIONS</strong></li>
</ul>

<p>From this file you can manually customize all those values, however for
the port I prefer to use the web interface.</p>

<h4 id="auto-deploy">Auto Deploy</h4>

<p>Auto Deploy is the only one of the three services that is not enabled by
default. As in the Windows based vCenter version Auto Deploy relies on
two services:</p>

<ul>
  <li>DHCP</li>
  <li>TFTP</li>
</ul>

<p>In the vCenter Server Appliance those services are included in the SuSE
Linux the appliance is based on. However by default thoser services are
stopped and are configured to do not start during the system startup
process.</p>

<p>These services require of some configuration before they can be used.</p>

<p><strong>DHCP:</strong></p>

<p>The configuration file for DHCP is <code>/etc/dhcpd.conf</code> but instead of
using the default configuration file make a backup of this file and
substitute the original with a copy of <code>/etc/dhcpd.conf.template</code>.</p>

<p>Once that is done edit the file, it should look like this.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image34.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb34.png" alt="image" title="image" /></a></p>

<p>Substitute the values between @@ with the values for your network. You
may have to comment some of the lines. My dhcpd.conf file is below as
reference:</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image35.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb35.png" alt="image" title="image" /></a></p>

<p>Next you have to modify the <code>/etc/sysconfig/dhcpd</code> file. In this file
is where the interfaces to listen at for the DHCP server are configured.</p>

<p>Check the <code>DCHP_INTERFACE</code> variable.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image36.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb36.png" alt="image" title="image" /></a></p>

<p>If it is empty edit the file and set the value to eth0.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image37.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb37.png" alt="image" title="image" /></a></p>

<p>With the configuration done we need to start the service.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image38.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb38.png" alt="image" title="image" /></a></p>

<p>And configure the service startup level.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image39.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb39.png" alt="image" title="image" /></a></p>

<p><strong>TFTP:</strong></p>

<p>The configuration file for TFTP server is <code>/etc/sysconfig/atftp</code>. There is
no need to modify this file since it will work with the default values.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image40.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb40.png" alt="image" title="image" /></a></p>

<p>To use a different directory for TFTP server modify the
<code>ATFTPD_DIRECTORY</code> variable. If you list the contents of that
directory you can see the PXE boot files used during the boot of the
ESXi server by the Auto Deploy service.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image41.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb41.png" alt="image" title="image" /></a></p>

<p>Start the <code>atftpd</code> daemon.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image42.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb42.png" alt="image" title="image" /></a></p>

<p>And set the startup level for the service.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image43.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb43.png" alt="image" title="image" /></a></p>

<p>With the DHCP and TFTP service properly configured and running we can
now go back to the VCSA web administration interface and start Auto
Deploy. To perform the startup of the service simply click in the <em>Start
ESXi Services</em> button.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image44.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb44.png" alt="image" title="image" /></a></p>

<h4 id="collecting-vm-support-scripts">Collecting vm-support scripts</h4>

<p>We all know how to generate a support bundle in previous vCenter Server
versions and in the 5.0 Windows based one using the vSphere Client or
from the Windows OS.</p>

<p>For the VCSA the vSphere Client method is completely valid but of course
since it is running on SuSE Linux the Windows method doesn’t apply.
Instead VMware has provided us with two additional methods, one from the
Web administration interface and one from the Linux shell.</p>

<p><strong>- Linux shell method</strong></p>

<p>As root go to <code>/usr/lib/vmware-vpx</code> and run the <code>vm-support.sh</code>
script. By default this script will generate the bundle in the current
directory but you specify an alternate location with the <code>-w</code> flag.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image45.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb45.png" alt="image" title="image" /></a></p>

<p>When the operation is done the following message will appear.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image46.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb46.png" alt="image" title="image" /></a></p>

<p>Go to the directory where the file has been generated to check it. You
can have a quick look of the contents of the bundle using <code>unzip -l</code>.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image47.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb47.png" alt="image" title="image" /></a></p>

<p>You can download the bundle to your system using you favorite SCP
client.</p>

<p><strong>- Web UI method</strong></p>

<p>Go the <em>vCenter Server</em> tab and in the <em>Status</em> section there is a link
to generate the bundle.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image48.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb48.png" alt="image" title="image" /></a></p>

<p>Click on the link, a new tab/windows will show up where the log of the
operation is displayed. The page refresh every ten seconds until the
operation is done.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image49.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb49.png" alt="image" title="image" /></a></p>

<p>Then a link to download the bundle will appear. If you look carefully at
the log you will see that this method is no more than a more user
friendly version of the Linux shell one.</p>

<p>This file is located at
<code>/tmp/vc-support-bundle/&lt;randomly_generated_directory&gt;</code>.</p>

<p><a href="http://jreypo.files.wordpress.com/2011/11/image50.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb50.png" alt="image" title="image" /></a></p>

<p>We are done with the vCenter services post. In the next posts I’ll show
you how to manage the embedded DB2 database.</p>

<p>Juanma.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/virtualization/vmware/vcenter-server-appliance-part-2-vcenter-associated-services/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/virtualization/vmware/vcenter-server-appliance-part-2-vcenter-associated-services/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/virtualization/vmware/vcenter-server-appliance-part-2-vcenter-associated-services/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>vCenter Server Appliance. Part 2 - vCenter associated services</strong> was published on <time datetime="2011-11-30T12:45:45+01:00">November 30, 2011</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/openstack/vmware/upgrading-vmware-integrated-openstack/" title="Upgrading VMware Integrated OpenStack">Upgrading VMware Integrated OpenStack</a></li>
    
      <li><a href="/cloud/openstack/give-me-openstack-and-give-me-liberty/" title="Give me OpenStack and give me Liberty!">Give me OpenStack and give me Liberty!</a></li>
    
      <li><a href="/linux/red%20hat/sysadmin/dnf-the-new-fedora-package-manager/" title="DNF, the new Fedora package manager">DNF, the new Fedora package manager</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Juan Manuel Rey. <br> Hosted on <a href="https://pages.github.com" rel="nofollow" target="_blank">GitHub Pages</a> and powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
