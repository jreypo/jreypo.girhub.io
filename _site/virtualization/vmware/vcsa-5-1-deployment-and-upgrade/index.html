<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>VCSA 5.1– Deployment and upgrade &#8211; Juanma's Blog</title>
<meta name="description" content="In the last
post we
discussed about the new features and changes that comes with version 5.1
of the VMware vCenter Server Appliance. In this new one I will
explain how to deploy it and perform an upgrade.

">
<meta name="keywords" content="vCenter Server, vCenter Server Appliance, VCSA, vSphere, vSphere 5.1">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="VCSA 5.1– Deployment and upgrade">
<meta name="twitter:description" content="In the last
post we
discussed about the new features and changes that comes with version 5.1
of the VMware vCenter Server Appliance. In this new one I will
explain how to deploy it and perform an upgrade.

">
<meta name="twitter:site" content="@jreypo">


<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="VCSA 5.1– Deployment and upgrade">
<meta property="og:description" content="In the last
post we
discussed about the new features and changes that comes with version 5.1
of the VMware vCenter Server Appliance. In this new one I will
explain how to deploy it and perform an upgrade.

">
<meta property="og:url" content="/virtualization/vmware/vcsa-5-1-deployment-and-upgrade/">
<meta property="og:site_name" content="Juanma's Blog">

<meta property="og:image" content="/images/default-thumb.png">






<link rel="canonical" href="/virtualization/vmware/vcsa-5-1-deployment-and-upgrade/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Juanma's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Juanma's Blog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				        
				    
				    <li><a href="/vmware-hp-links/" >HP Resources for VMware</a></li>
				
				    
				        
				    
				    <li><a href="/tags/" >Tags</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    
  

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/" class="bio-photo" alt=" bio photo">


  <h3 itemprop="name"></h3>
  <p></p>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/virtualization/vmware/vcsa-5-1-deployment-and-upgrade/" rel="bookmark" title="VCSA 5.1– Deployment and upgrade">VCSA 5.1– Deployment and upgrade</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>In the <a href="/2012/08/28/vcva-5-1-a-quick-look/" title="VCSA 5.1– A quick look">last
post</a> we
discussed about the new features and changes that comes with version 5.1
of the <strong>VMware vCenter Server Appliance</strong>. In this new one I will
explain how to deploy it and perform an upgrade.</p>

<h4 id="vcsa-deployment">VCSA Deployment</h4>

<p>The deployment of the VCSA 5.1 is very similar to the previous version.
Use the vSphere Client to deploy a new OVF template and browse to the
VCSA OVA package, follow the instructions until you get to the
<em>Networking Properties</em> screen.</p>

<p>Here you can pre-set the networking configuration values of the
appliance.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb.png" alt="image" title="image" /></a></p>

<p>If you are going to do a fresh VCSA or vSphere installation enter the
appropriate values on each field. If you want to perform an upgrade
instead leave them blank to get the info by DHCP or put a temporal IP
address if there is no DCHP server in place. You don’t need to put here
the final values since during the upgrading process all the network
settings will be migrated.</p>

<p>Let the deployment process finish and power on the vCenter appliance.
During the boot process you can see how the network configuration is
applied to the VM.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image1.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb1.png" alt="image" title="image" /></a></p>

<p>And finally you will reach the familiar blue screen.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image2.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb2.png" alt="image" title="image" /></a></p>

<p>That’s it, now proceed to the <em>WebUI</em> to complete VCSA setup. In your
first log into the vCenter a wizard will appear.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image3.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb3.png" alt="image" title="image" /></a></p>

<p>After accepting the EULA you will presented with four options:</p>

<ul>
  <li>Configure with default settings</li>
  <li>Upgrade from a previous version, which also gives you the option to
use the default Single Sign On configuration.</li>
  <li>Upload configuration file. Very useful in case your vCenter Server
virtual machine gets corrupted or you messed it up, if have a saved
copy of the most recent configuration file you can deploy a new
appliance and quickly restore its settings by uploading it.</li>
  <li>Set custom configuration &lt;- I used this option for my
homelab testing.</li>
</ul>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image4.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb4.png" alt="image" title="image" /></a></p>

<p>In the next screen you choose which database you want to use, the
<strong>vPostgres</strong> embedded or an Oracle external.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image5.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb5.png" alt="image" title="image" /></a></p>

<p>Now we must choose the options for the <strong>Single Sign On</strong> server.
vCenter 5.1 comes with a new component known as the Single Sign On
server, or SSO.</p>

<p>SSO allows an administrator to login through the vSphere Web Client or
the API and perform operations across all components of the vCloud Suite
without having to log into them separately. It integrates with multiple
identity sources like Windows Active Directory, NIS and OpenLDAP. The
SSO is a requirement for the Inventory Service, vCenter Server and the
Web Client.</p>

<p>In the Windows based vCenter installer SSO comes as a separate component
that can be installed in the same VM as the vCenter or in a different
one as a stand-alone server, in High Availability mode or even in a
multisite environment.</p>

<p>The VCSA comes with the SSO embedded however it is prepared to use an
external SSO server too. If choose the external SSO deployment mode all
the appropriate information must be provided in this screen. Again as
with the vCenter itself the database type must be set.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image6.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb6.png" alt="image" title="image" /></a></p>

<p>Finally set the Active Directory configuration accordingly to your
environment, review the configuration and click Start to begin.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image7.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb7.png" alt="image" title="image" /></a></p>

<p>At the end if everything goes fine you will see a screen with a
confirmation, click close and will see al the vCenter services up and
ready in the main screen of the <em>WebUI</em>.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image8.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb8.png" alt="image" title="image" /></a></p>

<p>The deployment and basic setup of the VCSA is done, at this point all
other components and settings can be setup from here.</p>

<h4 id="vcsa-upgrade">VCSA Upgrade</h4>

<p>The upgrade of the vCenter Server Appliance will allow to update to a
different OS version and migrate to a different database.</p>

<p>If you are upgrading from 5.0 to 5.1 and using the embedded database, it
will be migrated from IBM DB2 to <strong>VMware vPostgres</strong>.  The
configuration state will be preserved and the schema will be upgraded in
order to be compatible with 5.1. VCSA 5.0 Update 1 already comes with
vPostgres instead of DB2.</p>

<p>The major upgrade is supported from 5.0 and updates to 5.1.</p>

<p>The upgrading process is relatively simple:</p>

<ul>
  <li>Deploy VCSA 5.1.</li>
  <li>Set the 5.0 appliance as source and 5.1 as destination.</li>
  <li>Establish a connection between both VCSAs.</li>
  <li>Import network configuration of existing VCSA.</li>
</ul>

<!-- -->

<p>Deploy the appliance as shown above, log into the WebUI and in the
wizard accept the EULA in the first screen and select <em>Upgrade from
previous version</em> in the second, let <em>Use default SSO configuration</em> as
it comes by default.</p>

<p>The next screen that will be displayed is the Local and Remote Appliance
keys.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image9.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb9.png" alt="image" title="image" /></a></p>

<p>Here we have put the current VCSA 5.0 key. To do so go to the <em>Upgrade</em>
tab in VCSA 5.0 web interface. In the <em>Prepare</em> section select <em>source</em>
and click <em>Set role</em>.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image10.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb10.png" alt="image" title="image" /></a></p>

<p>Go back to the VCSA 5.1 and copy the <em>Local appliance key</em>. On the 5.0
appliance click on <em>Establish Trust</em> and paste the copied key in the
<em>Remote key appliance</em> key field. Click on <em>Import remote key</em> and wait
for the import to complete.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image11.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb11.png" alt="image" title="image" /></a></p>

<p>In the VCSA 5.0 copy the <em>Local appliance key</em>. Go to 5.1 vCenter, paste
that key on the <em>Remote appliance key</em> field of the setup wizard screen
and click <em>Next</em>. The <em>Pre-Upgrade Checker</em> screen will show up.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image12.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb12.png" alt="image" title="image" /></a></p>

<p>After this a check will be run against the ESX/ESXi managed by the old
VCSA and it will generate a report.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image13.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb13.png" alt="image" title="image" /></a></p>

<p>And the final screen will appear asking for confirmation. Click on the
confirmation checkbox and in Start.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image14.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb14.png" alt="image" title="image" /></a></p>

<p>During the upgrade VCSA 5.1 will shutdown the 5.0 virtual appliance and
assumes its network identity.</p>

<p>When the process is done a final screen will appear.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image15.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb15.png" alt="image" title="image" /></a></p>

<p>If you want to check if the process is done log into the VCSA through
SSH and list the vmware services, <strong>vmware-sso</strong> just to name one will
show up on the list.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image16.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb16.png" alt="image" title="image" /></a></p>

<p>Also you can access the vSphere Web Client and will see the new 5.1
client.</p>

<p><a href="http://jreypo.files.wordpress.com/2012/09/image17.png"><img src="%7B%7B%20site.baseurl%20%7D%7D/assets/image_thumb17.png" alt="image" title="image" /></a></p>

<p>Juanma.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/virtualization/vmware/vcsa-5-1-deployment-and-upgrade/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/virtualization/vmware/vcsa-5-1-deployment-and-upgrade/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/virtualization/vmware/vcsa-5-1-deployment-and-upgrade/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>VCSA 5.1– Deployment and upgrade</strong> was published on <time datetime="2012-09-05T18:22:43+02:00">September 05, 2012</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/openstack/vmware/upgrading-vmware-integrated-openstack/" title="Upgrading VMware Integrated OpenStack">Upgrading VMware Integrated OpenStack</a></li>
    
      <li><a href="/cloud/openstack/give-me-openstack-and-give-me-liberty/" title="Give me OpenStack and give me Liberty!">Give me OpenStack and give me Liberty!</a></li>
    
      <li><a href="/linux/red%20hat/sysadmin/dnf-the-new-fedora-package-manager/" title="DNF, the new Fedora package manager">DNF, the new Fedora package manager</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2015 Juan Manuel Rey. <br> Hosted on <a href="https://pages.github.com" rel="nofollow" target="_blank">GitHub Pages</a> and powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
